<!DOCTYPE html>
<html>

<head>
  <title>空汙烏賊戰 數據讓最髒的縣市現形</title>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="twitter:card" content="summary" />

  <!--/ for Facebook-->
  <meta property="og:title" content="空汙烏賊戰 數據讓最髒的縣市現形" />
  <meta property="og:url" content="https://udn.com/vote2018/graphics/topicthree" />
  <meta property="og:image" content="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/fb_meta.jpg" />
  <meta property="og:description" content="年底的地方首長選舉，「空汙」一詞始終都是各個政黨參選人互相抨擊與質疑的目標，《聯合報》從數據圖表出發，檢驗候選人的口水戰中誰真誰假。" />
  <meta property="og:site_name" content="聯合報" />
  <meta property="article:author" content="https://www.facebook.com/udnplus">
  <meta property="article:publisher" content="https://www.facebook.com/udnplus">

  <!--/ for Google-->
  <meta name="description" content="年底的地方首長選舉，「空汙」一詞始終都是各個政黨參選人互相抨擊與質疑的目標，《聯合報》從數據圖表出發，檢驗候選人的口水戰中誰真誰假。" />
  <meta name="copyright" content="聯合報" />
  <meta name="application-name" content="空汙烏賊戰 數據讓最髒的縣市現形" />
  <!--/ for follow & save-->

  <link rel="icon" type="image/ico" href="https://udn.com/upf/newmedia/image/udn-icon.ico" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/3.0.2/normalize.min.css" rel="stylesheet" type="text/css">
  <link href="https://s.udn.com.tw/static/font-icons/css/fontello.css" rel="stylesheet" type="text/css">
  <link href="https://s.udn.com.tw/static/font-icons/css/animation.css" rel="stylesheet" type="text/css">
  <link href="https://dc.udn.com/vulcan/TEK1803F0007/css/public.css" rel="stylesheet" type="text/css">

  <!-- ours google analytic -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-83853620-2', {'name': 'newmedia'});
    ga('newmedia.send', 'pageview');
  </script>

  <!-- Begin etu Tag -->
  <script id="etu-recommender" type="text/javascript">
    var temp = window.location.href.split('/')
    var pid = ''
    if (temp.length > 3) {
      pid = temp[temp.length - 3] + '_' + temp[temp.length - 2]
    }
    var erUrlPrefix = 'https://rec.udn.com/';
    var _qevents = _qevents || [];
    _qevents.push({
      group: 'udn',
      cid: 'udn_soft',
      act: 'view',
      cat: ['ubrand', 'ubrand', '', '', ''],
      uid: '',
      bid: '',
      pid: pid,
      page: 'ARTICLE',
      Rank_cat: '10',
      Rank_pid: '10',
      title: document.querySelector('title').innerHTML,
      tag: [],
      referral: document.referrer
    });
    (function () {
      var er = document.createElement('script');
      er.type = 'text/javascript';
      er.async = true;
      er.src = erUrlPrefix + 'er.js?' + (new Date().getTime());
      var currentJs = document.getElementById('etu-recommender');
      currentJs.parentNode.insertBefore(er, currentJs);
    })();
  </script>

</head>

<body>
  <div id="fb-root"></div>
  <script>
    (function (d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s);
      js.id = id;
      js.src = 'https://connect.facebook.net/zh_TW/sdk.js#xfbml=1&version=v2.12';
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
  </script>

  <!-- infographic-wrapper -->
  <div id="infographic-wrapper" class="infographic">
    <link href="./css/style.css" rel="stylesheet" type="text/css">

    <h1 class="infographic__title">空汙烏賊戰&nbsp;數據讓最髒的縣市現形</h1>

    <div class="infographic__share-wrapper">
      <div class="infographic__fb-share-wrapper">
        <div class="fb-like" data-href="" data-layout="button_count" data-action="like" data-size="large"
          data-show-faces="true" data-share="true"></div>
      </div>
      <div>
        <a href="https://social-plugins.line.me/lineit/share?url=https://udn.com/vote2018/graphics/topicthree"><img
            class="line-share" src="https://media.line.me/img/button/zh-hant/84x20.png" alt=""></a>
      </div>
    </div>
    <div class="infographic-content">
<p class="author">2018-09-20 聯合報 記者洪欣慈、陳雅玲、徐如宜、江良誠、王慧瑛、許瑋琳、楊若榆、林昱帆、實習記者游昊耘╱製作</p>
      <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/air_bg.jpg" class="mb-40" alt="空污圖">
      <p>空氣汙染是台灣近幾年的熱門議題，尤其鄰近2018年底的地方首長選舉，「空汙」一詞始終都是各個政黨參選人互相抨擊與質疑的目標，《聯合報》從數據圖表出發，檢驗候選人的口水戰中誰真誰假，發現最「髒」、最容易「橘爆」的縣市前三名分別是<strong>高雄市、嘉義市、南投縣</strong>。</p>
      <p class="mb-60">至於空氣品質屢次遭國民黨參選人盧秀燕砲轟的台中市，則一直都在改善前段班；北部空氣品質雖較佳，但學者直言「仍有隱憂」。</p>
    </div>
    <section>
      <h2 class="infographic__subtitle">第一站：台中的空氣是全國最糟？<br>其實是改善前段班</h2>
      <p class="mb-40">國民黨台中市長候選人盧秀燕狂轟現任市長林佳龍上任後，台中市空氣品質每況愈下，成為「闇黑」之都，林佳龍也不堪示弱地反駁，這幾年空汙防制得當，有「全台最宜居城市」稱號的台中市，空氣品質這幾年正持續進步。</p>
      <figure class="infographic__chart mb-40">
        <figcaption class="infographic__chart-caption">2014年 PM2.5年平均濃度
        </figcaption>
        <div class="infographic__detail">
          <u>點此看詳細資訊</u>
          <div class="infographic__detail-table">
            <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/close_btn.png" class="close-btn" alt="">
            <ul>
              <li>基隆市</li>
              <li>臺北市</li>
              <li>新北市</li>
              <li>桃園市</li>
              <li>新竹縣</li>
              <li>新竹市</li>
              <li>苗栗縣</li>
              <li>臺中市</li>
              <li>彰化縣</li>
              <li>南投縣</li>
              <li>雲林縣</li>
              <li>嘉義縣</li>
              <li>嘉義市</li>
              <li>臺南市</li>
              <li>高雄市</li>
              <li>屏東縣</li>
              <li>宜蘭縣</li>
              <li>花蓮縣</li>
              <li>臺東縣</li>
              <li>澎湖縣</li>
              <li>金門縣</li>
              <li>連江縣</li>
            </ul>
            <ul>
              <li>18.1</li>
              <li>19.8</li>
              <li>21</li>
              <li>22.5</li>
              <li>20.8</li>
              <li>23.1</li>
              <li>23</li>
              <li>25.4</li>
              <li>27.6</li>
              <li>29.8</li>
              <li>34.1</li>
              <li>34.7</li>
              <li>34.7</li>
              <li>30.2</li>
              <li>29.4</li>
              <li>31.6</li>
              <li>15.2</li>
              <li>13.7</li>
              <li>11.3</li>
              <li>16.8</li>
              <li>32.8</li>
              <li>24.2</li>
            </ul>
          </div>
        </div>
        <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/air_chart1.svg" alt="2014年PM2.5年平均濃度表">
        <div class="infographic__note">註：依空氣品質標準規定，PM2.5之監測數據以「手動監測」標準方法量測之數據為準<br>資料來源：環保署</div>
      </figure>
      <figure class="infographic__chart mb-40">
        <figcaption class="infographic__chart-caption">2017年 PM2.5年平均濃度
        </figcaption>
        <div class="infographic__detail">
          <u>點此看詳細資訊</u>
          <div class="infographic__detail-table">
            <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/close_btn.png" class="close-btn" alt="">
            <ul>
              <li>基隆市</li>
              <li>臺北市</li>
              <li>新北市</li>
              <li>桃園市</li>
              <li>新竹縣</li>
              <li>新竹市</li>
              <li>苗栗縣</li>
              <li>臺中市</li>
              <li>彰化縣</li>
              <li>南投縣</li>
              <li>雲林縣</li>
              <li>嘉義縣</li>
              <li>嘉義市</li>
              <li>臺南市</li>
              <li>高雄市</li>
              <li>屏東縣</li>
              <li>宜蘭縣</li>
              <li>花蓮縣</li>
              <li>臺東縣</li>
              <li>澎湖縣</li>
              <li>金門縣</li>
              <li>連江縣</li>
            </ul>
            <ul>
              <li>14.3</li>
              <li>15.3</li>
              <li>16.1</li>
              <li>17.4</li>
              <li>15.6</li>
              <li>17.6</li>
              <li>17.1</li>
              <li>19.2</li>
              <li>20.4</li>
              <li>22.5</li>
              <li>26.7</li>
              <li>23.2</li>
              <li>26</li>
              <li>24</li>
              <li>24.4</li>
              <li>27.8</li>
              <li>11.8</li>
              <li>9.8</li>
              <li>8.3</li>
              <li>15.3</li>
              <li>24.2</li>
              <li>20.5</li>
            </ul>
          </div>
        </div>
        <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/air_chart2.svg" alt="2017年PM2.5年平均濃度表">
        <div class="infographic__note">註：依空氣品質標準規定，PM2.5之監測數據以「手動監測」標準方法量測之數據為準<br>資料來源：環保署</div>
      </figure>
      <p>從數據來看，全台灣從2014到2017的PM2.5年平均濃度全數下降，台中也從21.8μg/m<sup>3</sup>掉到19.2μg/m<sup>3</sup>，<strong>改善比例11.9%</strong>。</p>
      <p class="mb-40">長期關注空汙議題的中興大學環境工程學系教授莊秉潔認為，除了環保署2017年推出的「14+N空氣污染防治策略」影響越趨明顯外，台中市政府多做了4件事，分別是補助中小型工廠燃油鍋爐改為燃氣、2016年率先全國公布的《生煤管制自治條例》以及廣設ubike與公車十公里免費，這些都有利於降低PM2.5，<strong>「也許不是改善幅度第一快，但絕對在前段班。」</strong></p>
      <figure class="mb-60">
        <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/air_2.jpg" alt="工廠排放廢氣圖">
        <figcaption class="infographic__img-caption">從環保署的數據來看，雲林縣空汙改善率確實是西半部第一，但改善這麼多，今年上半年PM2.5數值仍高居全台第三高。圖／報系資料照</figcaption>
      </figure>
    </section>
    <section>
      <h2 class="infographic__subtitle">第二站：雲林空氣品質改善率第一？<br>僅次於花蓮縣</h2>
      <p class="mb-40">百里侯戰開打之際，現任雲林縣縣長李進勇聲稱今年上半年雲林縣是西半部空氣品質改善率第一名，過去透過「源頭減量」、「管末加嚴」與「季節限定」三箭，來管制工業區生煤與石油焦的減量使用，防空汙政策似乎略有成效。</p>
      <figure class="infographic__chart mb-40">
        <figcaption class="infographic__chart-caption mb-40">PM2.5濃度比一比</figcaption>
        <div class="infographic__chart-button-wrapper">
          <div class="infographic__chart-button infographic__chart-button--seventeen active" id="seventeen-btn">2017</div>
          <div class="infographic__chart-button infographic__chart-button--eighteen" id="eighteen-btn">2018</div>
        </div>
        <p class="chart-button-prompt">點選年份按鈕可看數字變化</p>
        <svg class="stacked-bar-chart" width="100%" height="549"></svg>
        <div class="infographic__note">註：資料為2017上半年與2018上半年比較<br>資料來源：環保署</div>
      </figure>

      <p>從數據來看，今年上半年雲林縣PM2.5監測濃度26.4μg/m<sup>3</sup>較去年同期降低3.7μg/m<sup>3</sup>，<strong>改善比例達12%確實為西部第一，僅次於東部花蓮縣的37%</strong>。</p>
      <p class="mb-40"><strong>新竹市</strong>則是全台退步最多，PM2.5值與去年同期相比增加了15%。<strong>不過，雲林縣改善幅度雖大，但今年上半年PM2.5數值仍高居全台第三高</strong>，僅次於嘉義市的27.2μg/m<sup>3</sup>與金門縣的26.7μg/m<sup>3</sup>。</p>
      <figure class="infographic__chart mb-40">
        <figcaption class="infographic__chart-caption">這些縣市全年3成時間空氣好髒</figcaption>
        <div class="infographic__detail">
          <u>點此看詳細資訊</u>
          <div class="infographic__detail-table">
            <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/close_btn.png" class="close-btn" alt="">
            <ul>
              <li>基隆市</li>
              <li>臺北市</li>
              <li>新北市</li>
              <li>桃園市</li>
              <li>新竹縣</li>
              <li>新竹市</li>
              <li>苗栗縣</li>
              <li>臺中市</li>
              <li>彰化縣</li>
              <li><strong>南投縣</strong></li>
              <li><strong>雲林縣</strong></li>
              <li>嘉義縣</li>
              <li><strong>嘉義市</strong></li>
              <li>臺南市</li>
              <li><strong>高雄市</strong></li>
              <li>屏東縣</li>
              <li>宜蘭縣</li>
              <li>花蓮縣</li>
              <li>臺東縣</li>
              <li>澎湖縣</li>
              <li><strong>金門縣</strong></li>
              <li>連江縣</li>
            </ul>
            <ul>
              <li>4.93</li>
              <li>5.45</li>
              <li>9.07</li>
              <li>9.75</li>
              <li>8.78</li>
              <li>8.22</li>
              <li>9.04</li>
              <li>17</li>
              <li>16.58</li>
              <li><strong>32.6</strong></li>
              <li><strong>32.51</strong></li>
              <li>26.44</li>
              <li><strong>35.07</strong></li>
              <li>28.4</li>
              <li><strong>35.68</strong></li>
              <li>29.73</li>
              <li>1.65</li>
              <li>1.37</li>
              <li>0.27</li>
              <li>5.22</li>
              <li><strong>30.14</strong></li>
              <li>22.87</li>
            </ul>
          </div>
        </div>
        <img src=" https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/air_chart3.svg" alt="去年AQI>100台灣縣市地圖">
        <div class="infographic__note">註：資料為各縣市2017年AQI(PSI)>100日數比率<br>資料來源：環保署</div>
      </figure>
      <p>從環保署公布的統計來看，去年一整年空氣品質最容易「橘爆」的縣市前三名是<strong>高雄市、嘉義市、南投縣</strong>，第四名即為雲林縣的32.51%，與表現最佳、集中在東部的前三名台東縣、花蓮縣與宜蘭縣落在一成多相比高了30％以上。</p>
      <p><span class="infographic__para-highlight">高雄市</span>環保局長蔡孟裕回應，高雄市2017年AQI>100的日數的確是全國最高，但是在紅害減半大作戰上，PM2.5紅害站日數有降至214站日，達成預定目標230站。橘爆站日數雖然較2016年增加1.31%，但是AQI>150的紅害站日數由9.72%降至6.61%，減少了3.11</p>
      <p>蔡孟裕指出，高雄市因重工業產業密集、地理位置特殊，為全國空氣汙染最嚴峻的地區，且2017年全台降水日數較前一年減少，南部尤其明顯，由於懸浮微粒會受降雨的影響，也導致南部懸浮微粒明顯較前一年增加。</p>
      <p>雖然高雄市在去年空汙排行榜上是「劣等生」，但環保局統計2018年空汙改善情形，1至6月與去年上半年同期相比，總懸浮微粒由72.62μg/m<sup>3</sup>降至65.13μg/m<sup>3</sup>，減少了10.3%；AQI>100不良站日數比例，也由41.1%降至35.3%，今年高雄空品表現應該相對樂觀</p>
      <p><span class="infographic__para-highlight">南投縣</span>環保局長方信雄說，南投縣核准的生煤許可一天才4公噸，但台中火力電廠一天燃煤量就有5萬公噸，是南投全縣的1萬多倍，加上中龍鋼鐵也有2至3萬公噸，中央沒有從源頭控制排放，南投的空氣品質很難改善。</p>
      <p>方信雄說，環保局仍努力減少縣內的空汙，會針對砂石揚塵、工廠鍋爐、露天燃燒及汽機車廢氣加強稽查，將縣內的汙染排放降到最低，但還是需要中央趕快提出有效的空汙管制辦法，從源頭減少中火等的廢氣排放，否則南投全縣工廠都停工，只要中火不減少排放，南投空氣依舊難改善。</p>
      <p>南投縣長林明溱說，衛福部公布調查，南投縣民肺病變多，令鄉親恐慌不已。他直指南投空汙來源是台中火力發電廠，PM2.5雖著風向飄到南投縣，50萬名南投人呼吸不乾淨的空氣，才發生肺病變，他要求台中火力發電場燃煤減半，還給南投人乾淨的肺，如果再不改善，不惜率眾包圍發電廠。</p>
      <p><span class="infographic__para-highlight">雲林縣</span>環保局代理局長張喬維表示，縣府對空氣品質改善不曾鬆懈，今年度持續針對轄內的汙染源做改善，例如雲林科技工業區今年全廠區要從使用重油改成天然氣，就可以減少當地的汙染來源，也會持續推動移動車輛的汰換，減少汙染。</p>
      <p>另雲林縣中小型鍋爐已制定管制標準，近期將送環保署核定，張喬維表示，雲林縣雖積極從大汙染源到小汙染源全面改善，但空氣會流動，希望中央能夠做整體空氣汙染減量的規畫，才能讓空氣品質全面提升。</p>
      <p><span class="infographic__para-highlight">嘉義市</span>長涂醒哲說，嘉義市轄內工廠少，但機車密度卻是全國第二（僅次於台北市），加上嘉市是雲嘉地區中心，嘉義縣、雲林縣及北台南車輛常進出嘉義市活動，受移動汙染源排放空氣汙染物影響大。</p>
      <p  class="mb-40">不過，嘉義市紅色有害（AQI>150）日數已從103年的56日、104年32日、105年34日下降到106年的19日，顯示這幾年的改善措施有成效，未來將繼續讓橘色警戒（AQI>100）以上日數減少。</p>
      <figure class="mb-60">
        <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/air_3.jpg" alt="人群戴口罩圖">
        <figcaption class="infographic__img-caption">高雄市、嘉義市、南投縣是去年一整年空氣品質最容易「橘爆」的前三名縣市。圖／報系資料照
        </figcaption>
      </figure>
    </section>
    <section>
      <h2 class="infographic__subtitle">第三站：南北空氣品質差距擴大<br>北部也別開心太早
      </h2>
      <figure class="mb-40">
        <img src="https://p.udn.com.tw/upf/newmedia/2018_data/election_2018/topicthree/static/air_chart4.svg" alt="2016、2017年南北PM2.5手動年均濃度差距圖"">
        <div class="infographic__note">註：北部：苗栗以北；南部：雲林以南<br>資料來源：環保署</div>
      </figure>
      <p>從數據來看，2017年，高雄連得總懸浮微粒年均濃度與AQI>100日數比率冠軍，嘉義縣則為第二名，與去年總懸浮微粒年均濃度最低的新竹市相比，足足差了兩倍多。</p>
      <p>分析原因，除了南部原本就以重工業為主要產業結構外，台灣地球公民基金會副執行長王敏玲認為，中央政府資源長年南北分配不均的問題也不容忽視。過去10年中央政府多投入建置北部的大眾運輸系統，交通較不便的地區，路面移動汙染源數量自然較高。</p>
      <p>
        莊秉潔則提醒<strong>北部別掉以輕心</strong>。他指出，北部能源轉型進程較中部緩慢，在核能、煤與天然氣三大能源中，只有能快速升降、汙染少的天然氣發電，能填補再生能源的不確定性及缺口。
      </p>
      <p>莊秉潔指出，中部目前不只台中港天然氣接收站已進入環評階段，燃氣的通霄電廠新一號也已開始運轉，另有一座正在測試，預計九月開始運轉，未來中部的電會非常充足，就業機會也可能因此增加，「薪資成長幅度會比北部大。」</p>
      <p class="para-last">相反地，北部的深澳電廠即使取代燃油的基隆協和電廠，若深澳仍以燃煤發電，能見度雖會上升，燃煤排放的重金屬卻使PM2.5毒性相較過往協和電廠增加許多，「深澳電廠是錯誤的政策」，莊秉潔說。不只如此，<strong>北部目前仍缺乏完善天然氣規劃，未來北部電力該如何自主，避免中電北送，是北部民眾未來可能面臨的問題</strong>。</p>
    </section>
    <div class="fb-comments" data-href="https://udn.com/vote2018/graphics/topicthree" data-width="100%" data-numposts="5"></div>
    <div><br></div>
    <div><br></div>

  </div>
  <!-- infographic-wrapper -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.js"></script>
  <script>
    "use strict";

    var detailTrigger = document.querySelectorAll('.infographic__detail u');
    var detailTable = document.querySelectorAll('.infographic__detail-table');
    var closeBtn = document.querySelectorAll('.close-btn');
    var chartBtn = document.querySelectorAll('.infographic__chart-button');
    var seventeenBtn = document.getElementById('seventeen-btn');
    var eighteenBtn = document.getElementById('eighteen-btn');

    var _loop = function _loop(i) {
      detailTrigger[i].addEventListener('click', function () {
        detailTable[i].style.cssText = 'opacity: 1; pointer-events: auto;';
      });
      closeBtn[i].addEventListener('click', function () {
        detailTable[i].style.cssText = 'opacity: 0; pointer-events: none;';
      });
    };

    for (var i = 0; i < detailTrigger.length; i++) {
      _loop(i);
    }

    var is2018 = false;

    var seventeenBtnClick = function seventeenBtnClick() {
      for (var i = 0; i < chartBtn.length; i++) {
        chartBtn[i].classList.remove('active');
      };
      this.classList.add('active');
      is2018 = false;
      d3.selectAll('rect.bar').transition().duration(600).ease(d3.easeExp).attr('width', function (d) {
        return xScale(d['2017_concn']);
      }).attr('fill', '#5ae2db');
      d3.selectAll('text.bar-num').transition().duration(600).ease(d3.easeExp).attr('x', function (d) {
        return xScale(d['2017_concn']) + 6;
      }).style('opacity', 0).attr('fill', '#000');
      d3.selectAll('text.y-tick').transition().duration(600).ease(d3.easeExp).attr('fill', '#000');
    };

    var eighteenBtnClick = function eighteenBtnClick() {
      for (var i = 0; i < chartBtn.length; i++) {
        chartBtn[i].classList.remove('active');
      };
      this.classList.add('active');
      is2018 = true;
      d3.selectAll('rect.bar').transition().duration(600).ease(d3.easeExp).attr('width', function (d) {
        return xScale(d['2018_concn']);
      }).attr('fill', function (d) {
        if (d.city === '連江縣' || d.city === '新竹市' || d.city === '苗栗縣' || d.city === '桃園市' || d.city === '宜蘭縣' || d
          .city === '臺東縣' || d.city === '嘉義縣') {
          return '#ff4800';
        } else {
          return '#5ae2db';
        }
      });
      d3.selectAll('text.bar-num').transition().duration(600).ease(d3.easeExp).attr('x', function (d) {
        return xScale(d['2018_concn']) + 6;
      }).style('opacity', 1).attr('fill', function (d) {
        if (d.city === '連江縣' || d.city === '新竹市' || d.city === '苗栗縣' || d.city === '桃園市' || d.city === '宜蘭縣' || d
          .city === '臺東縣' || d.city === '嘉義縣') {
          return '#ff4800';
        }
      });
      d3.selectAll('text.y-tick').transition().duration(600).ease(d3.easeExp).attr('fill', function (d) {
        if (d.city === '連江縣' || d.city === '新竹市' || d.city === '苗栗縣' || d.city === '桃園市' || d.city === '宜蘭縣' || d
          .city === '臺東縣' || d.city === '嘉義縣') {
          return '#ff4800';
        } else {
          return '#000';
        }
      });
    };

    seventeenBtn.addEventListener('click', function () {
      seventeenBtnClick.call(this);
      clearTimeout(switchSeventeenBtn);
      clearTimeout(switchEighteenBtn);
    });
    eighteenBtn.addEventListener('click', function () {
      eighteenBtnClick.call(this);
      clearTimeout(switchSeventeenBtn);
      clearTimeout(switchEighteenBtn);
    });
    var switchSeventeenBtn;
    var switchEighteenBtn;

    var autoSwitchBtn = function autoSwitchBtn() {
      switchSeventeenBtn = setTimeout(function () {
        seventeenBtnClick.call(seventeenBtn);
        switchEighteenBtn = setTimeout(function () {
          eighteenBtnClick.call(eighteenBtn);
          autoSwitchBtn();
        }, 2500);
      }, 2500);
    };

    setTimeout(function () {
      eighteenBtnClick.call(eighteenBtn);
      autoSwitchBtn();
    }, 2500);
    var data = [{
      city: '基隆市',
      '2017_concn': 17.2,
      '2018_concn': 15.7
    }, {
      city: '臺北市',
      '2017_concn': 17.3,
      '2018_concn': 16.6
    }, {
      city: '新北市',
      '2017_concn': 19.3,
      '2018_concn': 18.4
    }, {
      city: '桃園市',
      '2017_concn': 19.4,
      '2018_concn': 20.3
    }, {
      city: '新竹縣',
      '2017_concn': 21.3,
      '2018_concn': 20.5
    }, {
      city: '新竹市',
      '2017_concn': 18.7,
      '2018_concn': 21.5
    }, {
      city: '苗栗縣',
      '2017_concn': 19.6,
      '2018_concn': 21.4
    }, {
      city: '臺中市',
      '2017_concn': 22.3,
      '2018_concn': 21
    }, {
      city: '彰化縣',
      '2017_concn': 24.6,
      '2018_concn': 24.6
    }, {
      city: '南投縣',
      '2017_concn': 29,
      '2018_concn': 25.7
    }, {
      city: '雲林縣',
      '2017_concn': 30.1,
      '2018_concn': 26.4
    }, {
      city: '嘉義縣',
      '2017_concn': 25.9,
      '2018_concn': 26.3
    }, {
      city: '嘉義市',
      '2017_concn': 30.8,
      '2018_concn': 27.2
    }, {
      city: '臺南市',
      '2017_concn': 28.1,
      '2018_concn': 26
    }, {
      city: '高雄市',
      '2017_concn': 29.5,
      '2018_concn': 26.2
    }, {
      city: '屏東縣',
      '2017_concn': 23.1,
      '2018_concn': 20.7
    }, {
      city: '宜蘭縣',
      '2017_concn': 12.9,
      '2018_concn': 13.6
    }, {
      city: '花蓮縣',
      '2017_concn': 13.2,
      '2018_concn': 8.3
    }, {
      city: '臺東縣',
      '2017_concn': 9.8,
      '2018_concn': 10.3
    }, {
      city: '澎湖縣',
      '2017_concn': 16.7,
      '2018_concn': 16
    }, {
      city: '金門縣',
      '2017_concn': 31.5,
      '2018_concn': 26.7
    }, {
      city: '連江縣',
      '2017_concn': 21.2,
      '2018_concn': 24.3
    }];
    data.sort(function (a, b) {
      a = a['2018_concn'] - a['2017_concn'];
      b = b['2018_concn'] - b['2017_concn'];
      return b - a;
    });
    var chart = d3.select('.stacked-bar-chart');
    var totalGroup = chart.append('g');
    var width = chart._groups[0][0].getBoundingClientRect().width - 49;
    var yTickValue = [0, 10, 20, 30, 40, 50];
    var xScale = d3.scaleLinear().domain([0, 50]).range([0, width]); // Resize Event

    window.addEventListener('resize', function () {
      width = chart._groups[0][0].getBoundingClientRect().width - 49;
      xScale = d3.scaleLinear().domain([0, 50]).range([0, width]);

      if (is2018) {
        d3.selectAll('rect.bar').attr('width', function (d) {
          return xScale(d['2018_concn']);
        });
        d3.selectAll('text.bar-num').attr('x', function (d) {
          return xScale(d['2018_concn']) + 6;
        });
      } else {
        d3.selectAll('rect.bar').attr('width', function (d) {
          return xScale(d['2017_concn']);
        });
        d3.selectAll('text.bar-num').attr('x', function (d) {
          return xScale(d['2017_concn']) + 6;
        });
      }

      xAxisGroup.selectAll('path').attr('d', "M48 528 l".concat(width, " 0 l0 1 l-").concat(width, " 0 Z"));
      xAxisGroup.selectAll('g.x-tick').attr('transform', function (d, i) {
        if (i === 0) {
          return 'translate(-2, 0)';
        } else if (i === 5) {
          return "translate(".concat(width - 15.56 + 1.5, ", 0)");
        } else {
          return "translate(".concat(width / 5 * i - 7.78, ", 0)");
        }
      });
    });
    /*
     ** Bar
     */

    var barGroup = totalGroup.append('g').selectAll('g.bar-group').data(data).enter().append('g').attr('class',
      'bar-group').attr('transform', function (d, i) {
      if (i === 0) {
        return 'translate(49, 3)';
      } else {
        return "translate(49, ".concat(18 * i + 6 * i + 3, ")");
      }
    });
    barGroup.append('rect').attr('class', 'bar').attr('fill', '#5ae2db').attr('width', function (d) {
      return xScale(d['2017_concn']);
    }).attr('height', 18);
    barGroup.append('text').attr('class', 'bar-num').text(function (d) {
        var cononGap = Math.round((d['2018_concn'] - d['2017_concn']) * 10) / 10;
        return cononGap > 0 ? "+".concat(cononGap, "%") : "".concat(cononGap, "%");
      }).style('opacity', 0).attr('x', function (d) {
      return xScale(d['2017_concn']) + 6;
    }).attr('y', 14).attr('fill', '#000');
    /*
     ** Y-axis
     */

    var yAxisGroup = totalGroup.append('g').attr('class', 'y-axis');
    yAxisGroup.selectAll('g.y-axis').data(data).enter().append('text').attr('class', 'y-tick').text(function (d) {
      return d['city'];
    }).attr('fill', '#000').attr('transform', function (d, i) {
      if (i === 0) {
        return 'translate(0, 17)';
      } else {
        return "translate(0, ".concat(18 * i + 6 * i + 17, ")");
      }
    });
    yAxisGroup.append('path').attr('fill', '#aaa').attr('d', 'M48 0 l0 528 l1 0 l0 -528 Z');
    /*
     ** X-axis
     */

    var xAxisGroup = totalGroup.append('g').attr('class', 'x-axis');
    var xTickGroup = xAxisGroup.append('g').attr('transform', 'translate(48, 545)').selectAll('g.x-axis').data(
      yTickValue).enter().append('g').attr('class', 'x-tick').attr('transform', function (d, i) {
      if (i === 0) {
        return 'translate(-2, 0)';
      } else if (i === 5) {
        return "translate(".concat(width - 15.56 + 1.5, ", 0)");
      } else {
        return "translate(".concat(width / 5 * i - 7.78, ", 0)");
      }
    });
    xAxisGroup.append('path').attr('fill', '#aaa').attr('d', "M48 528 l".concat(width, " 0 l0 1 l-").concat(width,
      " 0 Z"));
    xTickGroup.append('text').text(function (d) {
      return d;
    }).attr('fill', '#aaa').attr('transform', 'translate(0, 4)');
    xTickGroup.append('line').attr('y2', 6).attr('stroke', '#aaa').attr('transform', function (d, i) {
      if (i === 0) {
        return 'translate(2.5, -16)';
      } else if (i === 5) {
        return 'translate(13.6, -16)';
      } else {
        return 'translate(8.5, -16)';
      }
    });
  </script>

</body>

</html>