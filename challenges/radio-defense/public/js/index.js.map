{"version":3,"sources":["index.js"],"names":["updateFPS","time","globalColor","red","yellow","blue","blueDark","white","startBtn","document","getElementById","panel","addEventListener","game","startGame","once","gui","dat","GUI","Vec2","x","y","v","s","Math","sqrt","newVal","newLength","unit","mul","set","atan2","length","canvas","ctx","getContext","ww","wh","gameW","gameH","initCanvas","width","height","documentElement","clientWidth","clientHeight","degToPi","PI","coverCircle","coverTriangle","coverPolygon","circles","triangles","polygons","Game","args","def","isGameStart","shooter","currentLevel","isInLevel1","Object","assign","Circle","rotationAxisR","rotationAngle","r","Triangle","rotate","Polygon","p","scale","render","update","fillStyle","fillRect","draw","forEach","circle","drawCover","requestAnimationFrame","setLevelOne","setTimeout","save","translate","beginPath","arc","strokeStyle","stroke","globalAlpha","restore","drawBattery","moveTo","lineTo","closePath","fill","style","display","Shooter","cursor","push","rotationAxisPos","color","bullets","brforeShootTime","Date","bigCircleR","smallCircleR","subRotationAxisR","originalPos","cos","sin","bullet","shootTime","CircleBullet","canMove","rotateV","isInBoundary","random","xInRange","yInRange","shooterBullets","rotateAngle","shadowColor","shadowBlur","lineWidth","outerR","i","x1","y1","x2","y2","shieldR","shoot","mouseMoveAngle","ShooterBullet","add","movePos","handleLoad","init","window","mouseMovePos","handleMouseMove","evt","handleClick","beforeShootTime"],"mappings":"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","file":"index.js","sourcesContent":["/* Environment Variable */\r\nconst updateFPS = 30;\r\n// const showMouse = true;\r\n// const bgColor = 'black';\r\nlet time = 0;\r\n\r\nconst globalColor = {\r\n  red: \"#e7465d\",\r\n  yellow: \"#f5af5f\",\r\n  blue: \"#3676bb\",\r\n  blueDark: \"#001d2e\",\r\n  white: \"#fff\",\r\n};\r\n\r\nconst startBtn = document.getElementById('start-btn');\r\nconst panel = document.getElementById('panel');\r\nstartBtn.addEventListener('click',\r\n  function() {\r\n    game.startGame();\r\n  },\r\n  {\r\n    once: true,\r\n  }\r\n);\r\n\r\n\r\n/* GUI Controls */\r\n// const controls = {\r\n//   value: 0,\r\n// }\r\n\r\nconst gui = new dat.GUI();\r\n// gui.add(controls, 'value', -2, 2).step(0.01).onChange((value) => {});\r\n\r\n\r\n\r\n\r\n\r\n/* 2D Vector Class */\r\nclass Vec2 {\r\n  constructor(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n  set(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n  move(x, y) {\r\n    this.x += x;\r\n    this.y += y;\r\n  }\r\n  add(v) {\r\n    return new Vec2(this.x + v.x, this.y + v.y);\r\n  }\r\n  sub(v) {\r\n    return new Vec2(this.x - v.x, this.y - v.y);\r\n  }\r\n  mul(s) {\r\n    return new Vec2(this.x * s, this.y * s);\r\n  }\r\n  clone() {\r\n    return new Vec2(this.x, this.y);\r\n  }\r\n  equal(v) {\r\n    return this.x === v.x && this.y === v.y;\r\n  }\r\n  // toString() {\r\n  //   return `(${this.x}, ${this.y})`;\r\n  // }\r\n\r\n  get length() {\r\n    return Math.sqrt(this.x * this.x + this.y * this.y);\r\n  }\r\n  set length(newVal) {\r\n    const newLength = this.unit.mul(newVal);\r\n    this.set(newLength.x, newLength.y);\r\n  }\r\n  get angle() {\r\n    return Math.atan2(this.y, this.x);\r\n  }\r\n  get unit() {\r\n    return this.mul(1 / this.length);\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n/* Initialize Canvas Settings */\r\nconst canvas = document.getElementById('game');\r\nconst ctx = canvas.getContext('2d');\r\nlet ww;\r\nlet wh;\r\nlet gameW;\r\nlet gameH;\r\n\r\n// ctx.circle = function (v, r) {\r\n//   this.arc(v.x, v.y, r, 0, Math.PI * 2);\r\n// }\r\n// ctx.line = function (v1, v2) {\r\n//   this.moveTo(v1.x, v1.y);\r\n//   this.lineTo(v2.x, v2.y);\r\n// }\r\n\r\nfunction initCanvas() {\r\n  gameW = canvas.width;\r\n  gameH = canvas.height;\r\n  ww = document.documentElement.clientWidth;\r\n  wh = document.documentElement.clientHeight;\r\n}\r\n// initCanvas();\r\n\r\n\r\n\r\n\r\n\r\nconst degToPi = Math.PI / 180;\r\n// let circles = [];\r\nlet coverCircle;\r\nlet coverTriangle;\r\nlet coverPolygon;\r\nlet game;\r\n\r\nlet circles = [];\r\nlet triangles = [];\r\nlet polygons = [];\r\n\r\nclass Game {\r\n  constructor(args) {\r\n    const def = {\r\n      isGameStart: true,\r\n      // isGameStart: false,\r\n      shooter: null,\r\n      currentLevel: 1,\r\n      isInLevel1: false,\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  init() {\r\n    coverCircle = new Circle({\r\n      rotationAxisR: 380,\r\n      rotationAngle: -36,\r\n      r: 39,\r\n    });\r\n    coverTriangle = new Triangle({\r\n      rotationAxisR: {\r\n        x: 320,\r\n        y: 320,\r\n      },\r\n      rotationAngle: 40,\r\n      rotate: 32,\r\n      r: 44,\r\n    });\r\n    coverPolygon = new Polygon({\r\n      p: {\r\n        x: 72,\r\n        y: 96,\r\n      },\r\n      scale: 1.25,\r\n    });\r\n    this.startGame();\r\n    this.render();\r\n    this.update();\r\n  }\r\n  render() {\r\n    ctx.fillStyle = globalColor.blueDark;\r\n    // ctx.fillStyle = \"rgba(0, 0, 255, 0.1)\"\r\n    ctx.fillRect(0, 0, gameW, gameH);\r\n    if (this.isGameStart) {\r\n      this.shooter.draw();\r\n      circles.forEach((circle) => {\r\n        circle.draw();\r\n        // circle.bullets.forEach((bullet) => {\r\n        //   bullet.draw();\r\n        // });\r\n      });\r\n    } else {\r\n      // this.startGame();\r\n      this.drawCover();\r\n    }\r\n    requestAnimationFrame(() => { this.render() });\r\n  }\r\n  update() {\r\n    time += 1;\r\n    if (this.isGameStart) {\r\n      this.shooter.update();\r\n      if (this.currentLevel === 1 && !this.isInLevel1) {\r\n        this.setLevelOne();\r\n        this.isInLevel1 = true;\r\n      }\r\n      circles.forEach((circle) => {\r\n        circle.update();\r\n      });\r\n    }\r\n    setTimeout(() => { this.update() }, 1000 / updateFPS);\r\n  }\r\n  drawCover() {\r\n    // 中央兩白圈\r\n    ctx.save();\r\n      ctx.translate(gameW / 2, gameH / 2);\r\n      ctx.beginPath();\r\n      ctx.arc(0, 0, 180, 0, Math.PI * 2);\r\n      ctx.strokeStyle = globalColor.white;\r\n      ctx.stroke();\r\n      ctx.beginPath();\r\n      ctx.arc(0, 0, 264, 0, Math.PI * 2);\r\n      ctx.globalAlpha = 0.3;\r\n      ctx.stroke();\r\n    ctx.restore();\r\n    // 黃圓\r\n    coverCircle.draw();\r\n    coverCircle.update();\r\n    // 藍三角形\r\n    coverTriangle.draw();\r\n    coverTriangle.update();\r\n    // 紅多邊形\r\n    coverPolygon.draw();\r\n    coverPolygon.update();\r\n    // 電池\r\n    drawBattery({\r\n      x: gameW / 2 - 24,\r\n      y: gameH / 2 - 51.8,\r\n    });\r\n    // R 字小角裝飾\r\n    ctx.save();\r\n      ctx.translate(gameW / 2 + 24, gameH / 2 - 30);\r\n      ctx.rotate(-132 * degToPi);\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(4, 0);\r\n      ctx.lineTo(0, -8.4);\r\n      ctx.lineTo(-4.2, 0);\r\n      ctx.closePath();\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  startGame() {\r\n    this.isGameStart = true;\r\n    panel.style.display = 'none';\r\n    this.shooter = new Shooter();\r\n    canvas.style.cursor = 'pointer';\r\n  }\r\n  setLevelOne() {\r\n    circles.push(new Circle({\r\n      rotationAxisR: 240,\r\n      rotationAngle: 180,\r\n    }));\r\n  }\r\n}\r\n\r\n\r\n\r\n/* Circle Class */\r\nclass Circle {\r\n  constructor(args) {\r\n    const def = {\r\n      rotationAxisPos: {\r\n        x: gameW / 2,\r\n        y: gameH / 2,\r\n      },\r\n      rotationAxisR: 0,\r\n      rotationAngle: 0,\r\n      r: 22,\r\n      v: 0.8,\r\n      rotate: 0,\r\n      color: globalColor.yellow,\r\n      bullets: [],\r\n      brforeShootTime: new Date(),\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  get originalPos() {\r\n    return {\r\n      x: this.rotationAxisPos.x + this.rotationAxisR * Math.cos(this.rotationAngle * degToPi),\r\n      y: this.rotationAxisPos.y + this.rotationAxisR * Math.sin(this.rotationAngle * degToPi),\r\n    };\r\n  }\r\n  draw() {\r\n    const bigCircleR = this.r + 5;\r\n    const smallCircleR = this.r - 10;\r\n    const subRotationAxisR = 14;\r\n    ctx.save();\r\n      ctx.translate(this.originalPos.x, this.originalPos.y);\r\n      // 大淡圓\r\n      ctx.rotate(this.rotate * degToPi);\r\n      ctx.beginPath();\r\n      ctx.arc(-4, 0, bigCircleR, 0, Math.PI * 2);\r\n      ctx.fillStyle = 'rgba(245, 175, 95, 0.3)';\r\n      ctx.fill();\r\n      // 小淡圓\r\n      ctx.beginPath();\r\n      ctx.arc(20, 0, smallCircleR, 0, Math.PI * 2);\r\n      ctx.fillStyle = 'rgba(245, 175, 95, 0.3)';\r\n      ctx.fill();\r\n      // 主體圓\r\n      ctx.beginPath();\r\n      ctx.arc(0, 0, this.r, 0, Math.PI * 2);\r\n      ctx.fillStyle = this.color;\r\n      ctx.fill();\r\n      // 小三圓\r\n      ctx.beginPath();\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.arc(subRotationAxisR, 0, 2.4, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      ctx.beginPath();\r\n      ctx.arc(subRotationAxisR * Math.cos(120 * degToPi), subRotationAxisR * Math.sin(120 * degToPi), 2.4, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      ctx.beginPath();\r\n      ctx.arc(subRotationAxisR * Math.cos(240 * degToPi), subRotationAxisR * Math.sin(240 * degToPi), 2.4, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      // 神經\r\n      ctx.beginPath();\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.lineTo(8, 0);\r\n      ctx.lineTo(3 * Math.cos(32 * degToPi), 3 * Math.sin(32 * degToPi));\r\n      ctx.lineTo(12 * Math.cos(120 * degToPi), 12 * Math.sin(120 * degToPi));\r\n      ctx.lineTo(1 * Math.cos(170 * degToPi), 3 * Math.sin(170 * degToPi));\r\n      ctx.lineTo(8 * Math.cos(240 * degToPi), 8 * Math.sin(240 * degToPi));\r\n      ctx.lineTo(1 * Math.cos(320 * degToPi), 3 * Math.sin(320 * degToPi));\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      ctx.rotate(-this.rotate * degToPi);\r\n    ctx.restore();\r\n    // 子彈\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n  update() {\r\n    this.rotationAngle += this.v;\r\n    this.rotate += this.v;\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.update();\r\n    });\r\n    const shootTime = new Date();\r\n    if (shootTime - this.brforeShootTime > 800) {\r\n      this.bullets.push(new CircleBullet({\r\n        p: {\r\n          x: this.originalPos.x,\r\n          y: this.originalPos.y,\r\n        },\r\n        rotate: this.rotate,\r\n      }));\r\n      this.brforeShootTime = shootTime;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n/* Triangle Class */\r\nclass Triangle {\r\n  constructor(args) {\r\n    const def = {\r\n      rotationAxisPos: {\r\n        x: gameW / 2,\r\n        y: gameH / 2,\r\n      },\r\n      rotationAxisR: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      rotationAngle: 0,\r\n      r: 28,\r\n      rotate: 0,\r\n      v: -0.4,\r\n      color: globalColor.blue,\r\n      canMove: true,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.beginPath();\r\n    ctx.save();\r\n      ctx.translate(this.rotationAxisPos.x, this.rotationAxisPos.y);\r\n      ctx.translate(this.rotationAxisR.x * Math.cos(this.rotationAngle * degToPi), this.rotationAxisR.y * Math.sin(this.rotationAngle * degToPi)); \r\n      ctx.moveTo(this.r * Math.cos(0 + this.rotate * degToPi), this.r * Math.sin(0 + this.rotate * degToPi));\r\n      ctx.lineTo(this.r * Math.cos((120 + this.rotate) * degToPi), this.r * Math.sin((120 + this.rotate) * degToPi));\r\n      ctx.lineTo(this.r * Math.cos((240 + this.rotate) * degToPi), this.r * Math.sin((240 + this.rotate) * degToPi));\r\n    ctx.restore();\r\n    ctx.closePath();\r\n    ctx.fillStyle = this.color;\r\n    ctx.fill();\r\n  }\r\n  update() {\r\n    this.rotate += this.v;\r\n    // if (this.canMove) {\r\n    //   this.canMove = false;\r\n    //   setTimeout(() => {\r\n    //     TweenLite.to(this, 0.8, {\r\n    //       // rotationAngle: `${Math.random() < 0.5 ? '-=' : '+='}${Math.random() * 30 + 15}`,\r\n    //       rotationAngle: '+=90',\r\n    //       ease: Sine.easeInOut,\r\n    //       // onComplete: () => {\r\n    //       //   this.canMove = true;\r\n    //       // },\r\n    //     });\r\n    //     this.canMove = true;\r\n    //   }, 1200);\r\n    // }\r\n  }\r\n}\r\n\r\n\r\n\r\n/* Polygon Class */\r\nclass Polygon {\r\n  constructor(args) {\r\n    const def = {\r\n      p: new Vec2(0, 0),\r\n      v: {\r\n        x: 1,\r\n        y: 0.5,\r\n      },\r\n      scale: 1,\r\n      rotate: 0,\r\n      rotateV: 0.4,\r\n      color: globalColor.red,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.beginPath();\r\n      ctx.scale(this.scale, this.scale);\r\n      ctx.translate(this.p.x, this.p.y);\r\n      ctx.rotate(this.rotate * degToPi);\r\n      ctx.moveTo(0, 0);\r\n      ctx.rotate(20 * degToPi);\r\n      ctx.lineTo(32, 0);\r\n      ctx.translate(32, 0);\r\n\r\n      ctx.rotate(62 * degToPi);\r\n      ctx.lineTo(20, 0);\r\n      ctx.translate(20, 0);\r\n\r\n      ctx.rotate(40 * degToPi);\r\n      ctx.lineTo(28, 0);\r\n      ctx.translate(28, 0);\r\n\r\n      ctx.rotate(78 * degToPi);\r\n      ctx.lineTo(36, 0);\r\n      ctx.translate(36, 0);\r\n\r\n      ctx.rotate(44 * degToPi);\r\n      ctx.lineTo(34, 0);\r\n    ctx.restore();\r\n    ctx.fillStyle = this.color;\r\n    ctx.fill();\r\n  }\r\n  update() {\r\n    this.p.x += this.v.x;\r\n    this.p.y += this.v.y;\r\n    this.rotate += this.rotateV;\r\n    if (!this.isInBoundary) {\r\n      this.p.x = -48;\r\n      this.p.y = -32;\r\n      this.v.x = 0.5 * Math.random() + 0.5;\r\n      this.v.y = 0.5 * Math.random() + 0.5;\r\n    }\r\n  }\r\n  get isInBoundary() {\r\n    const xInRange = -48 <= this.p.x && this.p.x <= gameW + 48;\r\n    const yInRange = -48 <= this.p.y && this.p.y <= gameH + 48;\r\n    return xInRange && yInRange;\r\n  }\r\n}\r\n\r\n\r\n/* Shooter Class */\r\nlet shooterBullets = [];\r\nclass Shooter {\r\n  constructor(args) {\r\n    const def = {\r\n      p: {\r\n        x: gameW / 2,\r\n        y: gameH / 2,\r\n      },\r\n      color: globalColor.white,\r\n      r: 34,\r\n      rotateAngle: 0,\r\n      bullet: null,\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save(); \r\n      // 輪圍\r\n      ctx.translate(this.p.x, this.p.y);\r\n      ctx.save();\r\n        ctx.beginPath();\r\n        ctx.shadowColor = 'rgba(255, 255, 255, 0.4)';\r\n        ctx.shadowBlur = 16;\r\n        ctx.arc(0, 0, this.r, 0, Math.PI * 2);\r\n        ctx.strokeStyle = this.color;\r\n        ctx.lineWidth = 6;\r\n        ctx.stroke();\r\n        // 輪軸\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, 0);\r\n        ctx.lineTo(this.r * Math.cos(30 * degToPi + this.rotateAngle), this.r * Math.sin(30 * degToPi + this.rotateAngle));\r\n        ctx.moveTo(0, 0);\r\n        ctx.lineTo(this.r * Math.cos(150 * degToPi + this.rotateAngle), this.r * Math.sin(150 * degToPi + this.rotateAngle));\r\n        ctx.moveTo(0, 0);\r\n        ctx.lineTo(this.r * Math.cos(270 * degToPi + this.rotateAngle), this.r * Math.sin(270 * degToPi + this.rotateAngle));\r\n        ctx.lineWidth = 3;\r\n        ctx.stroke();\r\n      ctx.restore();\r\n      // 輪圍外虛線\r\n      // ctx.beginPath();\r\n      ctx.strokeStyle = this.color;\r\n      const outerR = this.r + 22;\r\n      for (let i = 0; i < 360; i += 1) {\r\n        // const angle1 = i;\r\n        // const angle2 = (i + 1);\r\n        const x1 = outerR * Math.cos(i * degToPi + this.rotateAngle);\r\n        const y1 = outerR * Math.sin(i * degToPi + this.rotateAngle);\r\n        const x2 = outerR * Math.cos((i + 1) * degToPi + this.rotateAngle);\r\n        const y2 = outerR * Math.sin((i + 1) * degToPi + this.rotateAngle);\r\n\r\n        if (i % 10 < 5) {\r\n          ctx.beginPath();\r\n          ctx.moveTo(x1, y1);\r\n          ctx.lineTo(x2, y2);\r\n          ctx.lineWidth = 1;\r\n          ctx.stroke();\r\n        }\r\n      }\r\n      // 護盾\r\n      const shieldR = this.r + 36;\r\n      ctx.beginPath();\r\n      ctx.arc(0, 0, shieldR, 45 * degToPi + this.rotateAngle, 135 * degToPi + this.rotateAngle);\r\n      ctx.lineWidth = 4;\r\n      ctx.stroke();\r\n      // 砲口\r\n      ctx.beginPath();\r\n      ctx.save();\r\n        ctx.shadowColor = 'rgba(255, 255, 255, 0.4)';\r\n        ctx.shadowBlur = 16;\r\n        ctx.rotate(this.rotateAngle)\r\n        ctx.translate(0, -this.r - 8);\r\n        ctx.moveTo(0, 0);\r\n        // 下方長方形長 16、寬（高） 12\r\n        // 上方梯形高 14、上邊寬 8\r\n        ctx.lineTo(8, 0);\r\n        ctx.lineTo(8, -12);\r\n        ctx.lineTo(4, -26);\r\n        ctx.lineTo(-4, -26);\r\n        ctx.lineTo(-8, -12);\r\n        ctx.lineTo(-8, 0);\r\n        ctx.closePath();\r\n        ctx.fillStyle = this.color;\r\n        ctx.fill();\r\n      ctx.restore();\r\n    ctx.restore();\r\n\r\n    this.shoot();\r\n  }\r\n  update() {\r\n    this.rotateAngle = mouseMoveAngle;\r\n    shooterBullets.forEach((bullet) => {\r\n      bullet.update();\r\n    });\r\n  }\r\n  shoot() {\r\n    shooterBullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n}\r\n\r\nclass ShooterBullet {\r\n  constructor(args) {\r\n    const def = {\r\n      p: new Vec2(0, 0),\r\n      // shootInterval: 0.4,\r\n      color: globalColor.white,\r\n      v: new Vec2(0, -6),\r\n      rotateAngle: 0,\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.beginPath();\r\n      ctx.translate(gameW / 2, gameH / 2);\r\n      ctx.rotate(this.rotateAngle);\r\n      ctx.translate(this.p.x, this.p.y);\r\n      // 殘影\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';\r\n      ctx.fillRect(-4, 0, 8, 4);\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\r\n      ctx.fillRect(-4, 4, 8, 4);\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';\r\n      ctx.fillRect(-4, 8, 8, 4);\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\r\n      ctx.fillRect(-4, 12, 8, 4);\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';\r\n      ctx.fillRect(-4, 16, 8, 4);\r\n      // 園底\r\n      ctx.arc(0, 0, 4, 0, Math.PI * 2);\r\n      ctx.fillStyle = this.color;\r\n      // ctx.fillStyle = 'red';\r\n      ctx.fill();\r\n      // 尖頭\r\n      ctx.beginPath();\r\n      ctx.moveTo(3, -3);\r\n      ctx.lineTo(0, -15);\r\n      ctx.lineTo(-3, -3);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  update() {\r\n    this.p = this.p.add(this.v);\r\n  }\r\n}\r\n\r\nclass CircleBullet {;\r\n  constructor(args) {\r\n    const def = {\r\n      p: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      movePos: new Vec2(0, 0),\r\n      color: globalColor.yellow,\r\n      v: new Vec2(2, 0),\r\n      rotate: 0,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.beginPath();\r\n      ctx.translate(this.p.x, this.p.y);\r\n      ctx.rotate(this.rotate * degToPi);\r\n      ctx.scale(1.6, 0.7);\r\n      ctx.arc(this.movePos.x + 22, this.movePos.y, 4, 0, Math.PI * 2);\r\n    ctx.restore();\r\n    ctx.fillStyle = this.color;\r\n    ctx.fill();\r\n  }\r\n  update() {\r\n    this.movePos = this.movePos.add(this.v);\r\n  }\r\n}\r\n\r\n// draw battery\r\nfunction drawBattery(p) {\r\n  ctx.save();\r\n    ctx.translate(p.x, p.y);\r\n    ctx.fillStyle = globalColor.yellow;\r\n    // 瓶身\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.lineTo(-24, 0);\r\n    ctx.lineTo(-24, 42);\r\n    ctx.lineTo(0, 42);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    // 瓶底\r\n    ctx.save();\r\n      ctx.translate(0, 44);\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(-24, 0);\r\n      ctx.lineTo(-24, 3);\r\n      ctx.lineTo(0, 3);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n    // 瓶蓋\r\n    ctx.fillStyle = globalColor.white;\r\n    ctx.save();\r\n      ctx.translate(-6.75, 0);\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(0, -3);\r\n      ctx.lineTo(-10.5, -3);\r\n      ctx.lineTo(-10.5, -0);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n    // 閃電\r\n    ctx.strokeStyle = globalColor.white;\r\n    ctx.translate(-11, 9);\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.rotate(18 * degToPi);\r\n    ctx.lineTo(0, 10);\r\n    ctx.translate(0, 10);\r\n    ctx.rotate(-18 * degToPi);\r\n\r\n    ctx.lineTo(10, 0);\r\n    ctx.translate(10, 0);\r\n\r\n    ctx.rotate(28 * degToPi);\r\n    ctx.lineTo(0, 16);\r\n    ctx.translate(0, 16);\r\n    ctx.rotate(-28 * degToPi);\r\n\r\n    ctx.rotate(3.6 * degToPi);\r\n    ctx.lineTo(0, -10);\r\n    ctx.translate(0, -10);\r\n    ctx.rotate(-3.6 * degToPi);\r\n\r\n    ctx.lineTo(-8, 0);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n  ctx.restore();\r\n}\r\n\r\n/* Initialize Game Logic */\r\n// function init() {\r\n\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n/* Update Game Logic */\r\n// function update() {\r\n//   time += 1;\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n/* Update Picture */\r\n// function draw() {\r\n  // clear background\r\n  // ctx.fillStyle = globalColor.blueDark;\r\n  // ctx.fillRect(0, 0, gameW, gameH);\r\n\r\n  // draw here\r\n  // ...\r\n\r\n  // draw mouse\r\n  // ctx.fillStyle = 'red';\r\n  // ctx.beginPath();\r\n  // ctx.circle(mouseMovePos, 3);\r\n  // ctx.fill();\r\n\r\n  // ctx.save();\r\n  // ctx.translate(mouseMovePos.x, mouseMovePos.y);\r\n  // ctx.strokeStyle = 'red';\r\n  // const length = 20;\r\n  // ctx.beginPath();\r\n  // ctx.fillText(mouseMovePos, 10, -10);\r\n  // ctx.line(new Vec2(-length, 0), new Vec2(length, 0));\r\n  // ctx.line(new Vec2(0, -length), new Vec2(0, length));\r\n  // ctx.stroke();\r\n  // ctx.restore();\r\n\r\n  // requestAnimationFrame(draw);\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n/* Page Loaded */\r\nfunction handleLoad() {\r\n  game = new Game();\r\n  initCanvas();\r\n  game.init();\r\n  // init();\r\n  // requestAnimationFrame(draw);\r\n  // setInterval(update, 1000 / updateFPS);\r\n}\r\n\r\n// load & resize event\r\nwindow.addEventListener('load', handleLoad);\r\nwindow.addEventListener('resize', initCanvas);\r\n\r\n\r\n\r\n\r\n\r\n/* Mouse Events & Recording */\r\n// const mouseMovePos = new Vec2(0, 0);\r\nlet mouseMovePos = {};\r\nlet mouseMoveAngle = 0;\r\n// let mouseUpPos = new Vec2(0, 0);\r\n// let mouseDownPos = new Vec2(0, 0);\r\n\r\n// window.addEventListener('mousemove', handleMouseMove);\r\n// window.addEventListener('mouseup', handleMouseUp);\r\n// window.addEventListener('mousedown', handleMouseDown);\r\ncanvas.addEventListener('mousemove', handleMouseMove);\r\n\r\nfunction handleMouseMove(evt) {\r\n  mouseMovePos.x = evt.x - ww / 2;\r\n  mouseMovePos.y = evt.y - wh / 2;\r\n  mouseMoveAngle = Math.atan2(mouseMovePos.y, mouseMovePos.x) - 270 * degToPi;\r\n};\r\n\r\ncanvas.addEventListener('click', handleClick);\r\n\r\nlet beforeShootTime = new Date();\r\nfunction handleClick() {\r\n  const shootTime = new Date();\r\n  if (shootTime - beforeShootTime > 200) {\r\n    shooterBullets.push(new ShooterBullet({\r\n      p: new Vec2(0, -34 - 12 - 16),\r\n      // p: new Vec2(0, -34 - 8 - 30),\r\n      rotateAngle: mouseMoveAngle,\r\n    }));\r\n    beforeShootTime = shootTime;\r\n  }\r\n};\r\n\r\n\r\n// function handleMouseUp(evt) {\r\n//   mouseUpPos = mouseMovePos.clone();\r\n// }\r\n\r\n// function handleMouseDown(evt) {\r\n//   mouseDownPos = mouseMovePos.clone();\r\n// }"]}