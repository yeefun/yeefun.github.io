{"version":3,"sources":["index.js"],"names":["updateFPS","time","globalColor","red","orange","yellow","blue","blueDark","white","controls","gui","dat","GUI","startBtn","document","getElementById","restartBtn","cover","gamePanel","batteryInfo","shooterHpBar","prop","propImg","propLastTime","batteryNum","result","resultNum","panel","container","keyboard","Vec2","x","y","v","s","Math","sqrt","newVal","newLength","unit","mul","set","atan2","length","canvas","ctx","getContext","ww","wh","gameW","gameH","$triLineTo","r","angle","angleAdd","lineTo","cos","degToPi","sin","initCanvas","width","height","documentElement","clientWidth","clientHeight","Prop","args","def","img","Image","src","axisRotateR","axisRotateAngle","Object","assign","complete","save","translate","originalPos","drawImage","beginPath","strokeStyle","arc","PI","stroke","restore","idx","shooter","game","cirSolidLineW","props","splice","propName","slice","split","getProp","coverCircle","coverTriangle","coverPolygon","Game","isStart","currentLevel","isInLevel1","circles","triangles","polygons","subTriangles","isPause","blockV","recoverHpTimer","boss","addEventListener","handleMouseMove","handleClick","window","handleKeyup","startGame","once","restartGame","render","update","setBlockV","recoverShooterHpBar","fillStyle","fillRect","drawBlock","draw","forEach","circle","triangle","polygon","subTriangle","drawMouse","requestAnimationFrame","setLevelOne","generateProp","setTimeout","lineWidth","i","moveTo","mouseMovePosX","mouseMovePos","mouseMovePosY","fill","random","style","display","Shooter","cursor","pointerEvents","textContent","opacity","clearTimeout","nowHpBarW","offsetWidth","recoverHpBarW","Boss","enemyMethods","dieEffect","enemyR","effectX","effectY","colorRGB","dieTime","effect","shadowColor","shadowBlur","effectR","baseLog","hitShooter","enemies","enemyIdx","type","enemyAxisRotateR","enemyAxisRotateAngle","enemy","shieldAngleRange","abs","mouseMoveAngle","judgeWhichEnemyHit","polygonR","HP","big","small","attackShooterResult","shieldR","shieldLineW","isProtect","bulletAttackShooter","enemyBulletLen","shooterBodyCore","shooterBodyShield","moveX","angleGap","rotateAngle","shooterHpBarOriginW","shooterHpBarW","isAttacked","shooterHeart","querySelectorAll","parentNode","removeChild","endGame","Circle","rotate","scale","axisRotateRV","axisRotateAngleV","rotateV","color","bullets","beforeRotateTime","Date","isRotating","isAppearing","appear","circleBigR","circleSmallR","subaxisRotateR","closePath","bullet","arr","rotateTime","TweenLite","to","ease","Power2","easeOut","onComplete","shoot","timer","push","CircleBullet","p","Back","config","from","Triangle","beforeRotateAxisAngleTime","beforeShootTime","isReproduce","shootTimer","triangleOuterBigR","triangleInnerBigR","triangleInnerSmallR","rotateAxisAngleTime","randomRotateAngle","Power0","easeNone","easeInOut","TriangleSub","order","TriangleBullet","Polygon","whole","isSplited","isSplitedMove","isSpliting","form","drawLightning","rotateDirection","Circ","statuses","outerR","x1","y1","x2","y2","judgeStatus","shootTime","bulletNum","ShooterBullet","waveLength","waveFreq","waveAmp","waveFlow","lastTime","recoverOneHeart","drawCrackdownEffect","displayPropInfo","shooterStatus","find","status","crackdownTime","polygonWholeR","polygonBigR","polygonSmallR","heartWrapper","heart","createElement","classList","add","insertBefore","firstChild","minusLastTime","log","bodyLength","drawWaveBullet","bulletIdx","anglePanFn","shotRRangeFn","bulletMoveLength","cirIdx","asin","attackEnemy","triIdx","lengthX","lengthY","polyIdx","sideA","attackPolygon","beyondBoundary","degree","enemyAnglePan","enemyAngleMinus","enemyAngleAdd","shotAngleRange","judgeShotAngleRange","shotRRange","sideB1Len","sideB2Len","angleAB1","angleAB2","rotateAngleJudge","polyAxisRotateAngle","polyRotate","sideB1","sideB2","sideC1","cosineFormula","sideC2","bottomJudge","topJudge","angleB1","angleB2","getAngleB","polyAngleMinus","polyAngleAdd","shooterRotateAngle","shooterAnglePan","shooterAngleMinus","shooterAngleAdd","isReproduceMoving","Power1","easeIn","moveXV","drawBattery","a","b","c","acos","handleLoad","init","evt","key","pauseGame"],"mappings":"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","file":"index.js","sourcesContent":["/* Environment Variable */\r\nconst updateFPS = 30;\r\n// const showMouse = true;\r\n// const bgColor = 'black';\r\nlet time = 0;\r\n\r\nconst globalColor = {\r\n  red: '#e7465d',\r\n  orange: '#f5af5f',\r\n  yellow: '#f7b52c',\r\n  blue: '#3676bb',\r\n  blueDark: '#001d2e',\r\n  white: '#fff',\r\n};\r\n\r\n\r\n/* GUI Controls */\r\nconst controls = {\r\n  // splited: false,\r\n  // length: 120,\r\n  // amp: 8,\r\n  // freq: 0.3,\r\n  // divide: 1,\r\n}\r\n\r\nconst gui = new dat.GUI();\r\n// gui.add(controls, 'length', 0, 200).step(1).onChange((value) => {});\r\n// gui.add(controls, 'amp', 0, 30).step(1).onChange((value) => {});\r\n// gui.add(controls, 'freq', 0, 1).step(0.1).onChange((value) => {});\r\n// gui.add(controls, 'divide', 1, 100).step(1).onChange((value) => {});\r\n\r\n// gui.add(controls, 'splited');\r\n// gui.add(controls, 'value', -2, 2).step(0.01).onChange((value) => {});\r\n\r\nconst startBtn = document.getElementById('start-btn');\r\nconst restartBtn = document.getElementById('restart-btn');\r\nconst cover = document.getElementById('cover');\r\nconst gamePanel = document.getElementById('game-panel');\r\nconst batteryInfo = document.getElementById('battery-info');\r\nconst shooterHpBar = document.getElementById('hp');\r\nconst prop = document.getElementById('prop');\r\nconst propImg = document.getElementById('prop__img');\r\nconst propLastTime = document.getElementById('prop__last-time');\r\nconst batteryNum = document.getElementById('battery-num');\r\nconst result = document.getElementById('result');\r\nconst resultNum = document.getElementById('result-num');\r\nconst panel = document.getElementById('panel');\r\nconst container = document.getElementById('container');\r\nconst keyboard = document.getElementById('keyboard');\r\n// const mouseStyle = document.getElementById('mouse-style');\r\n\r\n\r\n\r\n\r\n\r\n/* 2D Vector Class */\r\nclass Vec2 {\r\n  constructor(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n  set(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n  move(x, y) {\r\n    this.x += x;\r\n    this.y += y;\r\n  }\r\n  add(v) {\r\n    return new Vec2(this.x + v.x, this.y + v.y);\r\n  }\r\n  sub(v) {\r\n    return new Vec2(this.x - v.x, this.y - v.y);\r\n  }\r\n  mul(s) {\r\n    return new Vec2(this.x * s, this.y * s);\r\n  }\r\n  clone() {\r\n    return new Vec2(this.x, this.y);\r\n  }\r\n  equal(v) {\r\n    return this.x === v.x && this.y === v.y;\r\n  }\r\n  get length() {\r\n    return Math.sqrt(this.x * this.x + this.y * this.y);\r\n  }\r\n  set length(newVal) {\r\n    const newLength = this.unit.mul(newVal);\r\n    this.set(newLength.x, newLength.y);\r\n  }\r\n  get angle() {\r\n    return Math.atan2(this.y, this.x);\r\n  }\r\n  get unit() {\r\n    return this.mul(1 / this.length);\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n/* Initialize Canvas Settings */\r\nconst canvas = document.getElementById('game');\r\nconst ctx = canvas.getContext('2d');\r\nlet ww;\r\nlet wh;\r\nlet gameW;\r\nlet gameH;\r\n\r\n// ctx.circle = function (v, r) {\r\n//   this.arc(v.x, v.y, r, 0, Math.PI * 2);\r\n// }\r\n// ctx.line = function (v1, v2) {\r\n//   this.moveTo(v1.x, v1.y);\r\n//   this.lineTo(v2.x, v2.y);\r\n// }\r\n\r\nctx.$triLineTo = function(r, angle, angleAdd = 0) {\r\n  return ctx.lineTo(r * Math.cos(angle * degToPi + angleAdd), r * Math.sin(angle * degToPi + angleAdd));\r\n}\r\n\r\nfunction initCanvas() {\r\n  gameW = canvas.width;\r\n  gameH = canvas.height;\r\n  ww = document.documentElement.clientWidth;\r\n  wh = document.documentElement.clientHeight;\r\n}\r\n// initCanvas();\r\n\r\n\r\n\r\n\r\n\r\n/* 道具 class */\r\nclass Prop {\r\n  constructor(args) {\r\n    const def = {\r\n      img: new Image(),\r\n      src: '',\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      r: 32,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    if (!this.img.src) {\r\n      this.img.src = this.src;\r\n      // ctx.mozImageSmoothingEnabled = ctx.webkitImageSmoothingEnabled = ctx.msImageSmoothingEnabled = ctx.imageSmoothingEnabled = false;\r\n    }\r\n    if (this.img.complete) {\r\n      ctx.save();\r\n        ctx.translate(originalPos(this.axisRotateR, this.axisRotateAngle).x, originalPos(this.axisRotateR, this.axisRotateAngle).y);\r\n        ctx.drawImage(this.img, 0, 0);\r\n        ctx.beginPath();\r\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';\r\n        ctx.arc(this.img.width / 2, this.img.height / 2, this.r, 0, Math.PI * 2);\r\n        ctx.stroke();\r\n        // ctx.beginPath();\r\n        // ctx.fillStyle = 'red';\r\n        // ctx.arc(0, 0, 4, 0, Math.PI * 2);\r\n        // ctx.fill();\r\n      ctx.restore();\r\n    }\r\n  }\r\n  update(idx) {\r\n    this.axisRotateR -= 3.2;\r\n    // 當道具撞上 shooter 主體\r\n    const shooter = game.shooter;\r\n    if ((this.axisRotateR + this.r) <= (shooter.r + (shooter.cirSolidLineW / 2))) {\r\n      game.props.splice(idx, 1);\r\n      const propName = this.src.slice(17).split('.')[0];\r\n      shooter.getProp(propName);\r\n    }\r\n  }\r\n}\r\n\r\n\r\nconst degToPi = Math.PI / 180;\r\nlet coverCircle;\r\nlet coverTriangle;\r\nlet coverPolygon;\r\nlet game;\r\n\r\n\r\n\r\nclass Game {\r\n  constructor(args) {\r\n    const def = {\r\n      isStart: true,\r\n      shooter: null,\r\n      currentLevel: 1,\r\n      isInLevel1: false,\r\n      props: [],\r\n      batteryNum: 0,\r\n      circles: [],\r\n      triangles: [],\r\n      polygons: [],\r\n      subTriangles: [],\r\n      isPause: false,\r\n      blockV: {\r\n        x: -2,\r\n        y: 2,\r\n      },\r\n      recoverHpTimer: null,\r\n      boss: null,\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  init() {\r\n    // coverCircle = new Circle({\r\n    //   axisRotateR: 380,\r\n    //   axisRotateAngle: -36,\r\n    //   r: 39,\r\n    // });\r\n    // coverTriangle = new Triangle({\r\n    //   axisRotateR: {\r\n    //     x: 320,\r\n    //     y: 320,\r\n    //   },\r\n    //   axisRotateAngle: 40,\r\n    //   rotate: 32,\r\n    //   r: 44,\r\n    // });\r\n    // coverPolygon = new Polygon({\r\n    //   p: {\r\n    //     x: 72,\r\n    //     y: 96,\r\n    //   },\r\n    //   scale: 1.25,\r\n    // });\r\n    canvas.addEventListener('mousemove', handleMouseMove);\r\n    canvas.addEventListener('click', handleClick);\r\n    window.addEventListener('keyup', handleKeyup);\r\n    startBtn.addEventListener('click', () => {\r\n      this.startGame();\r\n    }, {\r\n      once: true\r\n    });\r\n    // restartBtn.addEventListener('click', this.restartGame);\r\n    restartBtn.addEventListener('click', () => {\r\n      this.restartGame();\r\n    });\r\n    this.startGame();\r\n    this.render();\r\n    this.update();\r\n    // 初始化方格移動速率與計時器\r\n    this.setBlockV();\r\n    // 緩慢恢復 shooter 生命條\r\n    this.recoverShooterHpBar();\r\n  }\r\n  render() {\r\n    ctx.fillStyle = globalColor.blueDark;\r\n    ctx.fillRect(0, 0, gameW, gameH);\r\n    // if (this.isStart) {\r\n    // 繪製方格\r\n    this.drawBlock();\r\n    // 繪製 shooter\r\n    this.shooter.draw();\r\n    // 繪製每個 circle\r\n    this.circles.forEach((circle) => {\r\n      circle.draw();\r\n    });\r\n    // 繪製每個 triangle\r\n    this.triangles.forEach((triangle) => {\r\n      triangle.draw();\r\n    });\r\n    // 繪製每個 polygon\r\n    this.polygons.forEach((polygon) => {\r\n      polygon.draw();\r\n    });\r\n    // 繪製每個 sub triangle\r\n    this.subTriangles.forEach((subTriangle) => {\r\n      subTriangle.draw();\r\n    });\r\n    // 繪製每個 prop（道具）\r\n    this.props.forEach((prop) => {\r\n      prop.draw();\r\n    });\r\n    // 繪製魔王\r\n    this.boss && this.boss.draw();\r\n    // 繪製滑鼠\r\n    this.drawMouse();\r\n    // } else {\r\n      // this.startGame();\r\n      // this.drawCover();\r\n    // }\r\n    requestAnimationFrame(() => {\r\n      this.render()\r\n    });\r\n  }\r\n  update() {\r\n    time += 1;\r\n    if (this.isStart) {\r\n      // 判斷現在是第幾關\r\n      if (this.currentLevel === 1 && !this.isInLevel1) {\r\n        this.setLevelOne();\r\n        this.isInLevel1 = true;\r\n      }\r\n      // 更新 shooter\r\n      this.shooter.update();\r\n      // 更新每個 circle\r\n      this.circles.forEach((circle, idx) => {\r\n        circle.update(idx);\r\n      });\r\n      // 更新每個 triangle\r\n      this.triangles.forEach((triangle, idx) => {\r\n        triangle.update(idx);\r\n      });\r\n      // 更新每個 polygon\r\n      this.polygons.forEach((polygon, idx) => {\r\n        polygon.update(idx);\r\n      });\r\n      // 更新每個 sub triangle\r\n      this.subTriangles.forEach((subTriangle, idx) => {\r\n        subTriangle.update(idx);\r\n      });\r\n      // 更新每個 prop（道具）\r\n      this.props.forEach((prop, idx) => {\r\n        prop.update(idx);\r\n      });\r\n      // 更新魔王\r\n      this.boss && this.boss.update();\r\n      // 產生道具\r\n      this.generateProp();\r\n    }\r\n    setTimeout(() => {\r\n      this.update();\r\n    }, 1000 / updateFPS);\r\n  }\r\n  // 繪製封面\r\n  drawCover() {\r\n    // if (this.rLogo.complete) {\r\n    //   ctx.drawImage(this.rLogo, gameW / 2 - 12, gameH / 2 - 70, 31 * 1.7, 38 * 1.7);\r\n    // }\r\n    // 中央兩白圈\r\n    // ctx.save();\r\n    //   ctx.translate(gameW / 2, gameH / 2);\r\n    //   ctx.beginPath();\r\n    //   ctx.arc(0, 0, 180, 0, Math.PI * 2);\r\n    //   ctx.strokeStyle = globalColor.white;\r\n    //   ctx.stroke();\r\n    //   ctx.beginPath();\r\n    //   ctx.arc(0, 0, 264, 0, Math.PI * 2);\r\n    //   ctx.globalAlpha = 0.3;\r\n    //   ctx.stroke();\r\n    // ctx.restore();\r\n    // 黃圓\r\n    // coverCircle.draw();\r\n    // coverCircle.update();\r\n    // 藍三角\r\n    // coverTriangle.draw();\r\n    // coverTriangle.update();\r\n    // 紅多邊形\r\n    // coverPolygon.draw();\r\n    // coverPolygon.update();\r\n    // 電池\r\n    // drawBattery({\r\n    //   x: gameW / 2 - 24,\r\n    //   y: gameH / 2 - 52,\r\n    // });\r\n    // R 字小角裝飾\r\n    // ctx.save();\r\n    //   ctx.translate(gameW / 2 + 24, gameH / 2 - 30);\r\n    //   ctx.rotate(-132 * degToPi);\r\n    //   ctx.beginPath();\r\n    //   ctx.moveTo(0, 0);\r\n    //   ctx.lineTo(4, 0);\r\n    //   ctx.lineTo(0, -8.4);\r\n    //   ctx.lineTo(-4.2, 0);\r\n    //   ctx.closePath();\r\n    //   ctx.fillStyle = globalColor.white;\r\n    //   ctx.fill();\r\n    // ctx.restore();\r\n  }\r\n  // 畫方格\r\n  drawBlock() {\r\n    ctx.save();\r\n      ctx.beginPath();\r\n      ctx.strokeStyle = 'rgba(255, 255, 255, 0.16)';\r\n      ctx.lineWidth = 0.4;\r\n      // 畫橫列\r\n      for (let i = 0; i < 18; i += 1) {\r\n        ctx.moveTo(i * 56 + ((time * this.blockV.x) % 56), 0);\r\n        ctx.lineTo(i * 56 + ((time * this.blockV.x) % 56), gameH);\r\n      }\r\n      // 畫直行\r\n      for (let i = 0; i < 14; i += 1) {\r\n        ctx.moveTo(0, i * 52 + ((time * this.blockV.y) % 52));\r\n        ctx.lineTo(gameW, i * 52 + ((time * this.blockV.y) % 52));\r\n      }\r\n      ctx.stroke();\r\n    ctx.restore();\r\n  }\r\n  // 畫滑鼠\r\n  drawMouse() {\r\n    const mouseMovePosX = mouseMovePos.x + gameW / 2;\r\n    const mouseMovePosY = mouseMovePos.y + gameH / 2;\r\n    const length = 12;\r\n    ctx.save();\r\n      ctx.translate(mouseMovePosX, mouseMovePosY);\r\n      ctx.strokeStyle = globalColor.white;\r\n      ctx.lineWidth = 0.8;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-length, 0);\r\n      ctx.lineTo(length, 0);\r\n      ctx.moveTo(0, -length);\r\n      ctx.lineTo(0, length);\r\n      ctx.stroke();\r\n    ctx.restore();\r\n    ctx.fillStyle = globalColor.white;\r\n    ctx.beginPath();\r\n    ctx.arc(mouseMovePosX, mouseMovePosY, 1.6, 0, Math.PI * 2);\r\n    ctx.fill();\r\n  }\r\n  // 設定方格移動速率\r\n  setBlockV() {\r\n    setTimeout(() => {\r\n      this.blockV.x = Math.random() * 8 - 4;\r\n      this.blockV.y = Math.random() * 8 - 4;\r\n      this.setBlockV();\r\n    }, 8000);\r\n  }\r\n  // 開始遊戲（當讀者按下 'Start Play' 按鈕）\r\n  startGame() {\r\n    this.isStart = true;\r\n    // 移除封面\r\n    cover.style.display = 'none';\r\n    // 顯示遊戲介面\r\n    gamePanel.style.display = 'block';\r\n    // 初始化 shooter\r\n    this.shooter = new Shooter();\r\n    // 隱藏預設滑鼠\r\n    container.style.cursor = 'none';\r\n    // 讓滑鼠點擊無效\r\n    panel.style.pointerEvents = 'none';\r\n  }\r\n  restartGame() {\r\n    this.isStart = true;\r\n    // 重設敵人\r\n    this.circles = [];\r\n    this.triangles = [];\r\n    this.polygons = [];\r\n    this.subTriangles = [];\r\n    // 電池資訊歸零\r\n    batteryNum.textContent = 0;\r\n    // 重設生命條\r\n    shooterHpBar.style.width = '216px';\r\n    // 初始化反患恢復生命條\r\n    this.recoverShooterHpBar();\r\n    // 重設 shooter\r\n    this.shooter = new Shooter();\r\n    // 隱藏結果\r\n    result.style.opacity = 0;\r\n    // 讓滑鼠點擊無效\r\n    panel.style.pointerEvents = 'none';\r\n    // 顯示獲得電池資訊\r\n    batteryInfo.style.opacity = 1;\r\n    // 顯示鍵盤指示\r\n    keyboard.style.opacity = 1;\r\n    this.isInLevel1 = false;\r\n  }\r\n  // 遊戲結束\r\n  endGame() {\r\n    this.isStart = false;\r\n    // 隱藏獲得電池資訊\r\n    batteryInfo.style.opacity = 0;\r\n    // 隱藏鍵盤指示\r\n    keyboard.style.opacity = 0;\r\n    // 貼上電池數量\r\n    resultNum.textContent = this.batteryNum;\r\n    // 顯示結果\r\n    result.style.opacity = 1;\r\n    // 顯示預設滑鼠\r\n    container.style.cursor = 'auto';\r\n    // 讓滑鼠可以點擊\r\n    panel.style.pointerEvents = 'auto';\r\n    // 清除生命條恢復計時器\r\n    clearTimeout(this.recoverHpTimer);\r\n  }\r\n  // 暫停遊戲\r\n  pauseGame() {\r\n    this.isPause = !this.isPause;\r\n  }\r\n  // 產生道具\r\n  generateProp() {\r\n\r\n  }\r\n  // 緩慢恢復 shooter 生命條\r\n  recoverShooterHpBar() {\r\n    this.recoverHpTimer = setTimeout(() => {\r\n      const nowHpBarW = shooterHpBar.offsetWidth;\r\n      if (nowHpBarW < 216) {\r\n        const recoverHpBarW = nowHpBarW + 1;\r\n        shooterHpBar.style.width = `${recoverHpBarW}px`;\r\n      }\r\n      this.recoverShooterHpBar();\r\n    }, 500);\r\n  }\r\n  // 設定第一關\r\n  setLevelOne() {\r\n    this.boss = new Boss({\r\n      axisRotateR: 240,\r\n      axisRotateAngle: 90,\r\n    });\r\n    // this.props.push(new Prop({\r\n    //   src: '../../src/assets/crackdown.svg',\r\n    //   axisRotateR: 200,\r\n    //   axisRotateAngle: 40,\r\n    // }));\r\n    // this.circles.push(new Circle({\r\n    //   axisRotateR: 240,\r\n    //   axisRotateAngle: 40,\r\n    //   rotate: 235,\r\n    // }));\r\n    // this.triangles.push(new Triangle({\r\n    //   axisRotateR: 280,\r\n    //   // axisRotateAngle 與 rotate 必須相同\r\n    //   axisRotateAngle: 230,\r\n    //   rotate: 230,\r\n    // }));\r\n    // this.polygons.push(new Polygon({\r\n    //   axisRotateR: {\r\n    //     whole: 280,\r\n    //     big: 280,\r\n    //     small: 280,\r\n    //   },\r\n    //   axisRotateAngle: {\r\n    //     whole: 210,\r\n    //     big: 210,\r\n    //     small: 210,\r\n    //   },\r\n    //   rotate: {\r\n    //     whole: 56,\r\n    //     big: 56,\r\n    //     small: 56,\r\n    //   },\r\n    // }));\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n/* \r\n ** 敵人方法\r\n */\r\nconst enemyMethods = {\r\n  // 死亡效果\r\n  dieEffect(enemyR, effectX, effectY, colorRGB) {\r\n    let dieTime = 1;\r\n    let effect = () => {\r\n      // FIXME 暫停後再啟動，效果就會直接消失，原因不明\r\n      if (!game.isPause) {\r\n        dieTime += 1;\r\n        ctx.beginPath();\r\n        ctx.save();\r\n        ctx.strokeStyle = `rgba(${colorRGB}, ${(48 - dieTime) / 46})`;\r\n        ctx.fillStyle = `rgba(${colorRGB}, ${(48 - dieTime) / 230})`;\r\n        ctx.shadowColor = `rgba(${colorRGB}, 0.48)`;\r\n        ctx.shadowBlur = 2;\r\n        ctx.lineWidth = 2;\r\n        const effectR = enemyR * baseLog(3, (((dieTime - 2) / 46) * 8) + 1);\r\n        ctx.arc(effectX, effectY, effectR, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.stroke();\r\n        ctx.restore();\r\n      }\r\n      if (dieTime < 48) {\r\n        requestAnimationFrame(effect);\r\n      }\r\n    }\r\n    requestAnimationFrame(effect);\r\n  },\r\n  // 敵人撞擊 shooter 判定\r\n  hitShooter(enemies, enemyIdx, type, enemyAxisRotateR, enemyAxisRotateAngle) {\r\n    const enemy = enemies[enemyIdx];\r\n    const shooter = game.shooter;\r\n    const shieldAngleRange = Math.abs(mouseMoveAngle - enemyAxisRotateAngle * degToPi) >= (135 * degToPi) && Math.abs(mouseMoveAngle - enemyAxisRotateAngle * degToPi) <= (225 * degToPi);\r\n    // 判斷是多邊形或其它敵人撞上 shooter\r\n    const judgeWhichEnemyHit = function () {\r\n      if (type !== 'big' && type !== 'small') {\r\n        enemies.splice(enemyIdx, 1);\r\n        // 移除敵人效果\r\n        if (type !== 'whole') {\r\n          const colorRGB = type === 'circle' ? '245, 175, 95' : '54, 118, 187';\r\n          enemyMethods.dieEffect(enemy.r, originalPos(enemyAxisRotateR, enemyAxisRotateAngle).x, originalPos(enemyAxisRotateR, enemyAxisRotateAngle).y, colorRGB);\r\n        } else {\r\n          const polygonR = (34 + 22) / 2;\r\n          enemyMethods.dieEffect(polygonR, enemy.originalPos(type).x, enemy.originalPos(type).y, '231, 70, 93');\r\n        }\r\n      } else {\r\n        enemy.HP[type] -= 1;\r\n        const polygonR = type === 'big' ? (34 + 22) / 2 : (23 + 21) / 2;\r\n        enemyMethods.dieEffect(polygonR, enemy.originalPos(type).x, enemy.originalPos(type).y, '231, 70, 93');\r\n        if (!enemy.HP.big && !enemy.HP.small) {\r\n          enemies.splice(enemyIdx, 1);\r\n        }\r\n      }\r\n    }\r\n    // 當敵人撞上 shooter 主體\r\n    if (enemyAxisRotateR <= (shooter.r + (shooter.cirSolidLineW / 2))) {\r\n      // shooter.HP -= 1;\r\n      judgeWhichEnemyHit();\r\n      enemyMethods.attackShooterResult();\r\n      // 當敵人撞上 shooter 護盾\r\n    } else if (shieldAngleRange && (enemyAxisRotateR <= (shooter.shieldR + (shooter.shieldLineW / 2)))) {\r\n      judgeWhichEnemyHit();\r\n      shooter.isProtect = true;\r\n    }\r\n  },\r\n  // 敵人子彈擊中 shooter 判定\r\n  bulletAttackShooter(enemy, enemyIdx, enemies, enemyBulletLen = 0) {\r\n    const shooter = game.shooter;\r\n    const shooterBodyCore = shooter.r + (shooter.cirSolidLineW / 2);\r\n    const shooterBodyShield = shooter.shieldR + (shooter.shieldLineW / 2);\r\n    // 當敵人子彈擊中 shooter 主體\r\n    if (-enemy.moveX >= (enemy.axisRotateR - (shooterBodyCore + enemyBulletLen))) {\r\n      // 子彈擊中後\r\n      enemyMethods.attackShooterResult();\r\n      // 移除敵人子彈\r\n      enemies.splice(enemyIdx, 1);\r\n    }\r\n    // 當敵人子彈射中 shooter 的護盾\r\n    const angleGap = Math.abs(mouseMoveAngle - (enemy.rotateAngle % 360) * degToPi);\r\n    const shieldAngleRange = angleGap >= (135 * degToPi) && angleGap <= (225 * degToPi);\r\n    if (shieldAngleRange && (-enemy.moveX >= (enemy.axisRotateR - (shooterBodyShield + enemyBulletLen)))) {\r\n      // 移除子彈\r\n      enemies.splice(enemyIdx, 1);\r\n    }\r\n  },\r\n  // 敵人撞擊或子彈擊中 shooter 後\r\n  attackShooterResult() {\r\n    const shooter = game.shooter;\r\n    const shooterHpBarOriginW = 216;\r\n    const shooterHpBarW = shooterHpBar.offsetWidth - (shooterHpBarOriginW / 3);\r\n    shooter.isAttacked = true;\r\n    // shooter 命減 1\r\n    // shooter.HP -= 1;\r\n    shooterHpBar.style.width = `${shooterHpBarW < 0 ? 0 : shooterHpBarW}px`;\r\n    if (shooterHpBarW <= 0) {\r\n      const shooterHeart = document.querySelectorAll('.panel__game-heart');\r\n      // 如果 shooter 還有愛心命\r\n      if (shooterHeart.length) {\r\n        // 減掉一個愛心\r\n        shooterHeart[0].parentNode.removeChild(shooterHeart[0]);\r\n        // 命條減 1/3\r\n        shooterHpBar.style.width = `${shooterHpBarOriginW}px`;\r\n      } else {\r\n        // 如果沒有，結束遊戲\r\n        game.endGame();\r\n      }\r\n    }\r\n  },\r\n};\r\n\r\n\r\n\r\n\r\n\r\n/* Circle Class */\r\nclass Circle {\r\n  constructor(args) {\r\n    const def = {\r\n      // axisRotatePos: {\r\n      //   x: gameW / 2,\r\n      //   y: gameH / 2,\r\n      // },\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      r: 22,\r\n      rotate: 0,\r\n      scale: 0,\r\n      axisRotateRV: 0.1,\r\n      axisRotateAngleV: 0.4,\r\n      rotateV: 0.4,\r\n      color: globalColor.orange,\r\n      HP: 2,\r\n      bullets: [],\r\n      beforeRotateTime: new Date(),\r\n      isRotating: false,\r\n      isAppearing: true,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    this.isAppearing && this.appear();\r\n    this.isAppearing = false;\r\n    const circleBigR = this.r + 5;\r\n    const circleSmallR = this.r - 10;\r\n    const subaxisRotateR = 14;\r\n    ctx.save();\r\n      ctx.translate(originalPos(this.axisRotateR, this.axisRotateAngle).x, originalPos(this.axisRotateR, this.axisRotateAngle).y);\r\n      ctx.rotate(this.rotate * degToPi);\r\n      ctx.scale(this.scale, this.scale);\r\n      // 大淡圓\r\n      ctx.beginPath();\r\n      ctx.arc(4, 0, circleBigR, 0, Math.PI * 2);\r\n      ctx.fillStyle = 'rgba(245, 175, 95, 0.21)';\r\n      ctx.fill();\r\n      // 小淡圓\r\n      ctx.beginPath();\r\n      ctx.arc(-20, 0, circleSmallR, 0, Math.PI * 2);\r\n      ctx.fillStyle = 'rgba(245, 175, 95, 0.21)';\r\n      ctx.fill();\r\n      // 主體圓\r\n      ctx.beginPath();\r\n      ctx.arc(0, 0, this.r, 0, Math.PI * 2);\r\n      ctx.fillStyle = this.color;\r\n      ctx.fill();\r\n      // 小三圓\r\n      ctx.beginPath();\r\n      ctx.fillStyle = globalColor.white;\r\n      // ctx.arc(subaxisRotateR, 0, 2.4, 0, Math.PI * 2);\r\n      ctx.arc(subaxisRotateR * Math.cos(60 * degToPi), subaxisRotateR * Math.sin(60 * degToPi), 2.4, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      ctx.beginPath();\r\n      ctx.arc(subaxisRotateR * Math.cos(180 * degToPi), subaxisRotateR * Math.sin(180 * degToPi), 2.4, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      ctx.beginPath();\r\n      ctx.arc(subaxisRotateR * Math.cos(300 * degToPi), subaxisRotateR * Math.sin(300 * degToPi), 2.4, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      // 神經\r\n      ctx.beginPath();\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.lineTo(-8, 0);\r\n      ctx.$triLineTo(-2, 32);\r\n      ctx.$triLineTo(-12, 120);\r\n      ctx.$triLineTo(-2.4, 176);\r\n      ctx.$triLineTo(-8, 240);\r\n      ctx.$triLineTo(-1.6, 320);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n    // 繪製圓形子彈\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n  update(idx) {\r\n    this.axisRotateR -= 1;\r\n    // 更新圓形子彈\r\n    this.bullets.forEach((bullet, idx, arr) => {\r\n      bullet.update(idx, arr);\r\n    });\r\n    // 當圓形自身在旋轉時，圓形不要移動\r\n    if (!this.isRotating) {\r\n      this.axisRotateAngle += this.axisRotateAngleV;\r\n      // this.axisRotateAngle += 2;\r\n    }\r\n    // 每 2-4 秒，自身旋轉一次\r\n    const rotateTime = new Date();\r\n    if (rotateTime - this.beforeRotateTime > 2000 * Math.random() + 2000) {\r\n      this.isRotating = true;\r\n      TweenLite.to(this, 0.4, {\r\n        // rotate: this.axisRotateAngle - 180,\r\n        // rotate: this.axisRotateAngle % 360,\r\n        rotate: this.axisRotateAngle,\r\n        ease: Power2.easeOut,\r\n        // 自身旋轉完後射擊\r\n        onComplete: () => {\r\n          this.shoot();\r\n          this.isRotating = false;\r\n        },\r\n      });\r\n      this.beforeRotateTime = rotateTime;\r\n    }\r\n    // 當圓形撞上 shooter\r\n    enemyMethods.hitShooter(game.circles, idx, 'circle', this.axisRotateR, this.axisRotateAngle);\r\n  }\r\n  shoot() {\r\n    // 射 1-2 發\r\n    for (let i = 0; i < 2 * Math.random(); i += 1) {\r\n      const timer = setTimeout(() => {\r\n        this.bullets.push(new CircleBullet({\r\n          p: {\r\n            x: originalPos(this.axisRotateR, this.axisRotateAngle).x,\r\n            y: originalPos(this.axisRotateR, this.axisRotateAngle).y,\r\n          },\r\n          rotateAngle: this.rotate,\r\n          moveX: -this.r - 10,\r\n          // rotateAngle: Math.sin(this.rotate * degToPi),\r\n          axisRotateR: this.axisRotateR,\r\n        }));\r\n        clearTimeout(timer);\r\n        // 間隔 0.2-0.4 秒\r\n      }, i * (200 * Math.random() + 200));\r\n    }\r\n  }\r\n  appear() {\r\n    TweenLite.to(this, 0.8, {\r\n      scale: 1,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n    TweenLite.from(this, 1.6, {\r\n      rotate: 0,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n/* Triangle Class */\r\nclass Triangle {\r\n  constructor(args) {\r\n    const def = {\r\n      // axisRotatePos: {\r\n      //   x: gameW / 2,\r\n      //   y: gameH / 2,\r\n      // },\r\n      // axisRotateR: {\r\n      //   x: 0,\r\n      //   y: 0,\r\n      // },\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      r: 26,\r\n      rotate: 0,\r\n      scale: 0,\r\n      axisRotateRV: 0.1,\r\n      axisRotateAngleV: 0.4,\r\n      rotateV: -2.4,\r\n      color: globalColor.blue,\r\n      bullets: [],\r\n      beforeRotateAxisAngleTime: new Date(),\r\n      beforeShootTime: new Date(),\r\n      HP: 4,\r\n      isReproduce: false,\r\n      shootTimer: null,\r\n      isAppearing: true,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    this.isAppearing && this.appear();\r\n    this.isAppearing = false;\r\n    const triangleOuterBigR = this.r + 4;\r\n    const triangleInnerBigR = this.r - 16;\r\n    const triangleInnerSmallR = this.r - 22;\r\n    ctx.save();\r\n      // 淡三角\r\n      ctx.translate(originalPos(this.axisRotateR, this.axisRotateAngle).x, originalPos(this.axisRotateR, this.axisRotateAngle).y);\r\n      ctx.scale(this.scale, this.scale);\r\n      ctx.rotate(this.rotate * degToPi);\r\n      ctx.save();\r\n        ctx.translate(4, 0);\r\n        ctx.beginPath();\r\n        ctx.moveTo(triangleOuterBigR * Math.cos(60 * degToPi), triangleOuterBigR * Math.sin(60 * degToPi));\r\n        ctx.$triLineTo(triangleOuterBigR, 180);\r\n        ctx.$triLineTo(triangleOuterBigR, 300);\r\n        ctx.closePath();\r\n        ctx.fillStyle = 'rgba(54, 118, 187, 0.34)';\r\n        ctx.fill();\r\n      ctx.restore();\r\n      // 主體三角\r\n      ctx.beginPath();\r\n      ctx.moveTo(this.r * Math.cos(60 * degToPi), this.r * Math.sin(60 * degToPi));\r\n      ctx.$triLineTo(this.r, 180);\r\n      ctx.$triLineTo(this.r, 300);\r\n      ctx.closePath();\r\n      ctx.fillStyle = this.color;\r\n      ctx.fill();\r\n      // 大白三角\r\n      ctx.translate(0, -2.8);\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.$triLineTo(triangleInnerBigR, 90);\r\n      ctx.$triLineTo(triangleInnerBigR, 150);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 小白三角\r\n      ctx.translate(8 * Math.cos(-40 * degToPi), 8 * Math.sin(-40 * degToPi))\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.$triLineTo(triangleInnerSmallR, 90);\r\n      ctx.$triLineTo(triangleInnerSmallR, 150);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n    // 繪製三角子彈\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n  update(idx) {\r\n    // this.axisRotateR -= 4.8;\r\n    // 更新三角子彈\r\n    this.bullets.forEach((bullet, idx, arr) => {\r\n      bullet.update(idx, arr);\r\n    });\r\n    // 每 8-16 秒，三角移動 + 自身旋轉\r\n    const rotateAxisAngleTime = new Date();\r\n    let randomRotateAngle;\r\n    if (rotateAxisAngleTime - this.beforeRotateAxisAngleTime > (Math.random() * 16000 + 8000)) {\r\n      // 旋轉時不發射子彈\r\n      if (this.shootTimer) clearTimeout(this.shootTimer);\r\n      randomRotateAngle = (Math.random() > 0.25 ? -1 : 1) * (30 * Math.random() + 45);\r\n      // 以 0.8 秒移動\r\n      TweenLite.to(this, 0.8, {\r\n        axisRotateAngle: `+=${randomRotateAngle}`,\r\n        ease: Power0.easeNone,\r\n      });\r\n      // 以 1.2 秒自身旋轉\r\n      TweenLite.to(this, 1.2, {\r\n        rotate: `+=${randomRotateAngle + 360}`,\r\n        ease: Power2.easeInOut,\r\n        onComplete: () => {\r\n          // 移動完後發射子彈\r\n          this.shoot();\r\n          // 發射一顆子彈後，每 2.4 - 10.4 秒發射第二發子彈\r\n          this.shootTimer = setTimeout(() => {\r\n            this.shoot();\r\n          }, (Math.random() * 8000 + 2400));\r\n        }\r\n      });\r\n      this.beforeRotateAxisAngleTime = rotateAxisAngleTime;\r\n    }\r\n    // 每 2.4-3.6 秒，發射 1 發子彈\r\n    // const shootTime = new Date();\r\n    // if (shootTime - this.beforeShootTime > (Math.random() * 1200 + 2400)) {\r\n    //   if (!this.bullets.length) {\r\n    //     this.shoot();\r\n    //   }\r\n    // }\r\n    // 當生命值剩 2，派副三角形攻擊\r\n    if (this.HP === 2 && !this.isReproduce) {\r\n      for (let i = 1; i <= 2; i += 1) {\r\n        game.subTriangles.push(new TriangleSub({\r\n          // axisRotateR: {\r\n          //   x: this.axisRotateR.x,\r\n          //   y: this.axisRotateR.y,\r\n          // },\r\n          axisRotateR: this.axisRotateR,\r\n          axisRotateAngle: this.axisRotateAngle,\r\n          rotate: this.rotate,\r\n          order: i,\r\n        }));\r\n      }\r\n      this.isReproduce = true;\r\n    }\r\n    // 當三角形撞上 shooter\r\n    enemyMethods.hitShooter(game.triangles, idx, 'triangle', this.axisRotateR, this.axisRotateAngle);\r\n  }\r\n  shoot() {\r\n    this.bullets.push(new TriangleBullet({\r\n      p: {\r\n        x: originalPos(this.axisRotateR, this.axisRotateAngle).x,\r\n        y: originalPos(this.axisRotateR, this.axisRotateAngle).y,\r\n      },\r\n      axisRotateR: this.axisRotateR,\r\n      rotateAngle: this.rotate,\r\n      // rotate: this.rotate,\r\n    }));\r\n  }\r\n  appear() {\r\n    TweenLite.to(this, 0.8, {\r\n      scale: 1,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n    TweenLite.to(this, 1.6, {\r\n      rotate: '+=360',\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n  }\r\n}\r\n\r\n\r\n\r\n/* Polygon 類別 */\r\nclass Polygon {\r\n  constructor(args) {\r\n    const def = {\r\n      // axisRotatePos: {\r\n      //   x: gameW / 2,\r\n      //   y: gameH / 2,\r\n      // },\r\n      axisRotateR: {\r\n        whole: 0,\r\n        big: 0,\r\n        small: 0,\r\n      },\r\n      axisRotateAngle: {\r\n        whole: 0,\r\n        big: 0,\r\n        small: 0,\r\n      },\r\n      rotate: {\r\n        whole: 0,\r\n        big: 0,\r\n        small: 0,\r\n      },\r\n      HP: {\r\n        whole: 1,\r\n        big: 1,\r\n        small: 1,\r\n      },\r\n      axisRotateRV: {\r\n        whole: 2.4,\r\n        big: 2.4,\r\n        small: 2.4,\r\n      },\r\n      // axisRotateRA: {\r\n      //   whole: 0.01,\r\n      //   big: 0.01,\r\n      //   small: 0.01,\r\n      // },\r\n      axisRotateAngleV: {\r\n        whole: 0.4,\r\n        big: 0.4,\r\n        small: 0.4,\r\n      },\r\n      rotateV: {\r\n        whole: 0.4,\r\n        big: 0.4,\r\n        small: 0.4,\r\n      },\r\n      color: globalColor.red,\r\n      isSplited: false,\r\n      isSplitedMove: false,\r\n      scale: 0,\r\n      isAppearing: true,\r\n      isSpliting: false,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  originalPos(form) {\r\n    return {\r\n      x: (gameW / 2) + this.axisRotateR[form] * Math.cos(this.axisRotateAngle[form] * degToPi),\r\n      y: (gameH / 2) + this.axisRotateR[form] * Math.sin(this.axisRotateAngle[form] * degToPi),\r\n    };\r\n  }\r\n  draw() {\r\n    if (!this.isSplited) {\r\n      this.isAppearing && this.appear();\r\n      this.isAppearing = false;\r\n      ctx.save();\r\n        ctx.translate(this.originalPos('whole').x, this.originalPos('whole').y);\r\n        ctx.rotate(this.rotate.whole * degToPi);\r\n        ctx.scale(this.scale, this.scale);\r\n        // 主體多邊形\r\n        ctx.beginPath();\r\n        ctx.fillStyle = this.color;\r\n        ctx.moveTo(21 * Math.cos(8 * degToPi), 21 * Math.sin(8 * degToPi));\r\n        ctx.$triLineTo(23, 70);\r\n        ctx.$triLineTo(23, 150);\r\n        ctx.$triLineTo(34, 202);\r\n        ctx.$triLineTo(22, 255);\r\n        ctx.$triLineTo(22, 324);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 右淡五邊形\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.07)';\r\n        ctx.moveTo(9.6, -2);\r\n        ctx.$triLineTo(22, 324);\r\n        ctx.$triLineTo(21, 8);\r\n        ctx.$triLineTo(23, 70);\r\n        ctx.$triLineTo(10, 36);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 下淡四邊形\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.21)';\r\n        ctx.moveTo(10 * Math.cos(40 * degToPi), 10 * Math.sin(40 * degToPi));\r\n        ctx.$triLineTo(23, 70);\r\n        ctx.$triLineTo(23, 150);\r\n        ctx.lineTo(-8.8, 0);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 閃電\r\n        drawLightning({\r\n          x: -0.8,\r\n          y: -16\r\n        });\r\n      ctx.restore();\r\n    } else {\r\n      // 大分裂四邊形\r\n      if (this.HP.big) {\r\n        ctx.save();\r\n          ctx.translate(this.originalPos('big').x, this.originalPos('big').y);\r\n          ctx.rotate(this.rotate.big * degToPi);\r\n          // 大分裂主體\r\n          ctx.beginPath();\r\n          ctx.fillStyle = this.color;\r\n          ctx.moveTo(23 * Math.cos(70 * degToPi), 23 * Math.sin(70 * degToPi));\r\n          ctx.$triLineTo(23, 150);\r\n          ctx.$triLineTo(34, 202);\r\n          ctx.$triLineTo(22, 255);\r\n          ctx.closePath();\r\n          ctx.fill();\r\n          // 大分裂內下四邊形\r\n          ctx.fillStyle = 'rgba(255, 255, 255, 0.21)';\r\n          ctx.beginPath();\r\n          ctx.moveTo(-8.8, 0);\r\n          ctx.$triLineTo(4.8, 64);\r\n          ctx.$triLineTo(23, 70);\r\n          ctx.$triLineTo(23, 150);\r\n          ctx.closePath();\r\n          ctx.fill();\r\n          // 大分裂左閃電\r\n          drawLightning({\r\n            x: -12,\r\n            y: -8\r\n          }, 0.6);\r\n        ctx.restore();\r\n      }\r\n      // 小分裂四邊形\r\n      if (this.HP.small) {\r\n        ctx.save();\r\n          ctx.translate(this.originalPos('small').x, this.originalPos('small').y);\r\n          ctx.rotate(this.rotate.small * degToPi);\r\n          // 小分裂主體\r\n          ctx.beginPath();\r\n          ctx.fillStyle = this.color;\r\n          ctx.moveTo(23 * Math.cos(70 * degToPi), 23 * Math.sin(70 * degToPi));\r\n          ctx.$triLineTo(22, 255);\r\n          ctx.$triLineTo(22, 324);\r\n          ctx.$triLineTo(21, 8);\r\n          ctx.closePath();\r\n          ctx.fill();\r\n          // 小分裂內下三角形\r\n          ctx.beginPath();\r\n          ctx.fillStyle = 'rgba(255, 255, 255, 0.21)';\r\n          ctx.moveTo(10 * Math.cos(40 * degToPi), 10 * Math.sin(40 * degToPi));\r\n          ctx.$triLineTo(4.8, 64);\r\n          ctx.$triLineTo(23, 70);\r\n          ctx.closePath();\r\n          ctx.fill();\r\n          // 小分裂內右五邊形\r\n          ctx.beginPath();\r\n          ctx.fillStyle = 'rgba(255, 255, 255, 0.07)';\r\n          ctx.moveTo(9.6, -2);\r\n          ctx.$triLineTo(22, 324);\r\n          ctx.$triLineTo(21, 8);\r\n          ctx.$triLineTo(23, 70);\r\n          ctx.$triLineTo(10, 36);\r\n          ctx.closePath();\r\n          ctx.fill();\r\n          // ctx.fillStyle = 'yellow';\r\n          // ctx.beginPath();\r\n          // ctx.arc(0, 0, 2, 0, Math.PI * 2)\r\n          // ctx.fill();\r\n          // 小分裂閃電\r\n          drawLightning({\r\n            x: 10,\r\n            y: -8\r\n          }, 0.5);\r\n        ctx.restore();\r\n      }\r\n    }\r\n  }\r\n  update(idx) {\r\n    if (!this.HP.whole) {\r\n      this.isSplited = true;\r\n    }\r\n    if (!this.isSplited) {\r\n      // this.axisRotateR.whole = this.axisRotateR.big = this.axisRotateR.small -= this.axisRotateRV.whole;\r\n      this.rotate.whole = this.rotate.big = this.rotate.small += this.rotateV.whole;\r\n      // 當多邊形撞上 shooter\r\n      enemyMethods.hitShooter(game.polygons, idx, 'whole', this.axisRotateR.whole, this.axisRotateAngle.whole);\r\n    } else {\r\n      if (!this.isSplitedMove) {\r\n        // const rotateOriginPos = 90 - 70;\r\n        // const rotateDirection = (((this.rotate.whole % 360) >= rotateOriginPos) && ((this.rotate.whole % 360) < (180 + rotateOriginPos))) ? -1 : 1;\r\n        const rotateDirection = Math.random() > 0.5 ? 1 : -1;\r\n        TweenLite.to(this.axisRotateAngle, 2.4, {\r\n          big: `+=${(Math.random() * 15 + 15) * rotateDirection}`,\r\n          small: `-=${(Math.random() * 15 + 15) * rotateDirection}`,\r\n          ease: Circ.easeOut,\r\n        });\r\n        TweenLite.to(this.axisRotateR, 2.4, {\r\n          big: `+=${(Math.random() * 100 + 50)}`,\r\n          small: `+=${(Math.random() * 100 + 50)}`,\r\n          ease: Circ.easeOut,\r\n          onComplete: () => {\r\n            this.isSpliting = true;\r\n          }\r\n        });\r\n        TweenLite.to(this.rotate, 3.2, {\r\n          big: `-=${Math.random() * 90 + 180}`,\r\n          small: `+=${Math.random() * 90 + 180}`,\r\n          ease: Power2.easeOut,\r\n        });\r\n        this.isSplitedMove = true;\r\n      }\r\n      // 當大分裂撞上 shooter\r\n      if (this.HP.big && this.isSpliting) {\r\n        this.axisRotateR.big -= this.axisRotateRV.big;\r\n        // this.axisRotateRV.big += this.axisRotateRA.big;\r\n        enemyMethods.hitShooter(game.polygons, idx, 'big', this.axisRotateR.big, this.axisRotateAngle.big);\r\n      }\r\n      // 當小分裂撞上 shooter\r\n      if (this.HP.small && this.isSpliting) {\r\n        this.axisRotateR.small -= this.axisRotateRV.small;\r\n        enemyMethods.hitShooter(game.polygons, idx, 'small', this.axisRotateR.small, this.axisRotateAngle.small);\r\n      }\r\n    }\r\n    // if (!this.isInBoundary) {\r\n    //   this.p.x = -48;\r\n    //   this.p.y = -32;\r\n    //   this.v.x = 0.5 * Math.random() + 0.5;\r\n    //   this.v.y = 0.5 * Math.random() + 0.5;\r\n    // }\r\n  }\r\n  appear() {\r\n    TweenLite.to(this, 0.8, {\r\n      scale: 1,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n  }\r\n  // get isInBoundary() {\r\n  //   const xInRange = -48 <= this.p.x && this.p.x <= gameW + 48;\r\n  //   const yInRange = -48 <= this.p.y && this.p.y <= gameH + 48;\r\n  //   return xInRange && yInRange;\r\n  // }\r\n}\r\n\r\n\r\n\r\n\r\n\r\nclass Boss {\r\n  constructor(args) {\r\n    const def = {\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      rotate: 0,\r\n      axisRotateRV: 1,\r\n      axisRotateAngleV: 1,\r\n      rotateV: 1,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.translate(originalPos(this.axisRotateR, this.axisRotateAngle).x, originalPos(this.axisRotateR, this.axisRotateAngle).y);\r\n      ctx.rotate(this.rotate * degToPi);\r\n      // 透明頭\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(11, 0);\r\n      ctx.lineTo(18, 6);\r\n      ctx.lineTo(18, 15);\r\n      ctx.lineTo(-18, 15);\r\n      ctx.lineTo(-18, 6);\r\n      ctx.lineTo(-11, 0);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 黃頭\r\n      ctx.fillStyle = globalColor.orange;\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 9);\r\n      ctx.lineTo(11, 9);\r\n      ctx.lineTo(18, 15);\r\n      ctx.lineTo(18, 36);\r\n      ctx.lineTo(-18, 36);\r\n      ctx.lineTo(-18, 15);\r\n      ctx.lineTo(-11, 9);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 右白肩\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.beginPath();\r\n      ctx.moveTo(18, -6);\r\n      ctx.lineTo(18 + 8, -6);\r\n      ctx.lineTo(18 + 8 + 8, 15);\r\n      ctx.lineTo(18 + 8 + 8, 36 + 6);\r\n      ctx.lineTo(18, 36 + 6);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 左白肩\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18, -6);\r\n      ctx.lineTo(-18 - 8, -6);\r\n      ctx.lineTo(-18 - 8 - 8, 15);\r\n      ctx.lineTo(-18 - 8 - 8, 36 + 6);\r\n      ctx.lineTo(-18, 36 + 6);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 右紅翼\r\n      ctx.fillStyle = globalColor.red;\r\n      ctx.beginPath();\r\n      ctx.moveTo(18 + 8 + 8, 9);\r\n      ctx.lineTo(18 + 8 + 8 + 8, 9);\r\n      ctx.lineTo(18 + 8 + 8 + 8 + 16, 36 + 6);\r\n      ctx.lineTo(18 + 8 + 8 + 8 + 16, 36 + 6 + 8);\r\n      ctx.lineTo(18 + 8 + 8, 36 + 6 + 8);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 左藍翼\r\n      ctx.fillStyle = globalColor.blue;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18 - 8 - 8 + 4, 9);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 + 4, 9);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 - 16 + 4, 36 + 6);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 - 16 + 4, 36 + 6 + 8);\r\n      ctx.lineTo(-18 - 8 - 8 + 4, 36 + 6 + 8);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 右灰風口\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(18 + 8 + 8, 36 + 6 + 8);\r\n      ctx.lineTo(18 + 8 + 8, 36 + 6 + 8 + 6);\r\n      ctx.lineTo(18 + 8 + 8 + 16, 36 + 6 + 8 + 6);\r\n      ctx.lineTo(18 + 8 + 8 + 16, 36 + 6 + 8);\r\n      ctx.fill();\r\n      // 左灰風口\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18 - 8 - 8 + 4, 36 + 6 + 8);\r\n      ctx.lineTo(-18 - 8 - 8 + 4, 36 + 6 + 8 + 6);\r\n      ctx.lineTo(-18 - 8 - 8 - 16 + 4, 36 + 6 + 8 + 6);\r\n      ctx.lineTo(-18 - 8 - 8 - 16 + 4, 36 + 6 + 8);\r\n      ctx.fill();\r\n      // 右裝飾白圈\r\n      ctx.strokeStyle = globalColor.white;\r\n      ctx.lineWidth = 2.8;\r\n      ctx.beginPath();\r\n      ctx.arc(18 + 8 + 8 + 11, 36 + 6 - 2, 4.4, 0, Math.PI * 2);\r\n      ctx.stroke();\r\n      // 左裝飾黃叉\r\n      ctx.strokeStyle = globalColor.orange;\r\n      // ctx.lineWidth = 2.8;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18 - 8 - 8 + 4 - 3.2, 9 + 16);\r\n      ctx.lineTo(-18 - 8 - 8 + 4 - 3.2 - 9.6, 9 + 16 + 9.6);\r\n      ctx.moveTo(-18 - 8 - 8 + 4 - 3.2 - 9.6, 9 + 16);\r\n      ctx.lineTo(-18 - 8 - 8 + 4 - 3.2, 9 + 16 + 9.6);\r\n      ctx.stroke();\r\n      // 裝飾內透明頭\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.25)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 9 + 8);\r\n      ctx.lineTo(4, 9 + 8);\r\n      ctx.lineTo(14, 24);\r\n      ctx.lineTo(14, 36 - 8);\r\n      ctx.lineTo(-14, 36 - 8);\r\n      ctx.lineTo(-14, 24);\r\n      ctx.lineTo(-4, 9 + 8);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 左裝飾透明四邊形\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.24)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18 - 8 - 8 - 8 - 16 + 4 + 4, 36 + 6 - 8.25);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 - 16 + 4, 36 + 6);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 - 16 + 4, 36 + 6 + 8);\r\n      ctx.lineTo(-18 - 8 - 8 - 6 + 4, 36 + 6 + 8);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  update() {\r\n    // this.axisRotateAngle += this.axisRotateAngleV;\r\n    // this.rotate += this.rotateV;\r\n  }\r\n}\r\n\r\n\r\n/* Shooter 類別 */\r\n// let shooterBullets = [];\r\nclass Shooter {\r\n  constructor(args) {\r\n    const def = {\r\n      // p: {\r\n      //   x: gameW / 2,\r\n      //   y: gameH / 2,\r\n      // },\r\n      color: globalColor.white,\r\n      // r: 34 * 0.85,\r\n      r: 28.9,\r\n      // shieldR: (34 + 36) * 0.85,\r\n      shieldR: 59.5,\r\n      // cirSolidLineW: 6 * 0.85,\r\n      cirSolidLineW: 5.1,\r\n      // shieldLineW: 4 * 0.85,\r\n      shieldLineW: 3.4,\r\n      rotateAngle: 0,\r\n      bullets: [],\r\n      // HP: 6,\r\n      // HP: 1,\r\n      statuses: [],\r\n      isAttacked: false,\r\n      isProtect: false,\r\n      beforeShootTime: new Date(),\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      // 輪圍\r\n      ctx.translate(gameW / 2, gameH / 2);\r\n      // ctx.rotate(this.rotateAngle);\r\n      ctx.save();\r\n        ctx.beginPath();\r\n        ctx.shadowColor = 'rgba(255, 255, 255, 0.4)';\r\n        ctx.shadowBlur = 16;\r\n        ctx.lineWidth = this.cirSolidLineW;\r\n        ctx.arc(0, 0, this.r, 0, Math.PI * 2);\r\n        if (!this.isAttacked) {\r\n          ctx.strokeStyle = this.color;\r\n        } else {\r\n          ctx.strokeStyle = globalColor.red;\r\n          this.isAttacked = false;\r\n        }\r\n        // ctx.strokeStyle = this.color;\r\n        ctx.stroke();\r\n        // 輪軸\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, 0);\r\n        ctx.$triLineTo(this.r, 0, this.rotateAngle);\r\n        ctx.moveTo(0, 0);\r\n        ctx.$triLineTo(this.r, 120, this.rotateAngle);\r\n        ctx.moveTo(0, 0);\r\n        ctx.$triLineTo(this.r, 240, this.rotateAngle);\r\n        // ctx.lineWidth = 3 * 0.85;\r\n        ctx.lineWidth = 2.55;\r\n        ctx.stroke();\r\n      ctx.restore();\r\n      // 輪圍外虛線\r\n      ctx.strokeStyle = this.color;\r\n      // const outerR = this.r + 22 * 0.85;\r\n      const outerR = this.r + 18.7;\r\n      for (let i = 0; i < 360; i += 1) {\r\n        const x1 = outerR * Math.cos(i * degToPi + this.rotateAngle);\r\n        const y1 = outerR * Math.sin(i * degToPi + this.rotateAngle);\r\n        const x2 = outerR * Math.cos((i + 1) * degToPi + this.rotateAngle);\r\n        const y2 = outerR * Math.sin((i + 1) * degToPi + this.rotateAngle);\r\n        if (i % 10 < 5) {\r\n          ctx.beginPath();\r\n          ctx.moveTo(x1, y1);\r\n          ctx.lineTo(x2, y2);\r\n          ctx.lineWidth = 1;\r\n          ctx.stroke();\r\n        }\r\n      }\r\n      // 護盾\r\n      ctx.beginPath();\r\n      ctx.lineWidth = this.shieldLineW;\r\n      // 如果 shooter 狀態為 shield，護盾變為 180°\r\n      if (!this.judgeStatus('shield')) {\r\n        ctx.arc(0, 0, this.shieldR, 135 * degToPi + this.rotateAngle, 225 * degToPi + this.rotateAngle);\r\n      } else {\r\n        ctx.arc(0, 0, this.shieldR, 90 * degToPi + this.rotateAngle, 270 * degToPi + this.rotateAngle);\r\n      }\r\n      if (!this.isProtect) {\r\n        ctx.strokeStyle = this.color;\r\n      } else {\r\n        ctx.strokeStyle = globalColor.blue;\r\n        this.isProtect = false;\r\n      }\r\n      ctx.stroke();\r\n      // 砲口\r\n      ctx.beginPath();\r\n      ctx.save();\r\n        ctx.shadowColor = 'rgba(255, 255, 255, 0.4)';\r\n        ctx.shadowBlur = 16;\r\n        ctx.rotate(this.rotateAngle);\r\n        // ctx.translate(this.r + 8, 0);\r\n        ctx.translate(this.r + 6.8, 0);\r\n        ctx.moveTo(0, 0);\r\n        // 下方長方形長 16、寬（高） 12\r\n        // 上方梯形高 14、上邊寬 8\r\n        // ctx.lineTo(0, 8 * 0.85);\r\n        // ctx.lineTo(12 * 0.85, 8 * 0.85);\r\n        // ctx.lineTo(26 * 0.85, 4 * 0.85);\r\n        // ctx.lineTo(26 * 0.85, -4 * 0.85);\r\n        // ctx.lineTo(12 * 0.85, -8 * 0.85);\r\n        // ctx.lineTo(0, -8 * 0.85);\r\n        // 下方長方形長 13.6、寬（高） 10.2\r\n        // 上方梯形高 11.8、上邊寬 6.8\r\n        ctx.lineTo(0, 6.8);\r\n        ctx.lineTo(10.2, 6.8);\r\n        ctx.lineTo(22.1, 3.4);\r\n        ctx.lineTo(22.1, -3.4);\r\n        ctx.lineTo(10.2, -6.8);\r\n        ctx.lineTo(0, -6.8);\r\n        ctx.closePath();\r\n        ctx.fillStyle = this.color;\r\n        ctx.fill();\r\n      ctx.restore();\r\n    ctx.restore();\r\n    // 發射子彈\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n  update() {\r\n    this.rotateAngle = mouseMoveAngle;\r\n    this.bullets.forEach((bullet, idx) => {\r\n      bullet.update(idx);\r\n    });\r\n  }\r\n  shoot() {\r\n    const shootTime = new Date();\r\n    if (shootTime - beforeShootTime > 400) {\r\n      let bulletNum;\r\n      // 如果 shooter 狀態為 double，每次射兩發，兩發之間隔 0.16 秒\r\n      if (!this.judgeStatus('double')) {\r\n        bulletNum = 1;\r\n      } else {\r\n        bulletNum = 2;\r\n      }\r\n      for (let i = 0; i < bulletNum; i++) {\r\n        if (!this.judgeStatus('wave')) {\r\n          setTimeout(() => {\r\n            this.bullets.push(new ShooterBullet({\r\n              // 34 + 12 + 16\r\n              // p: new Vec2(62, 0),\r\n              // axisRotateR: 62 * 0.85,\r\n              axisRotateR: 52.7,\r\n              rotateAngle: mouseMoveAngle,\r\n            }));\r\n          }, 160 * i);\r\n        } else {\r\n          setTimeout(() => {\r\n            this.bullets.push(new ShooterBullet({\r\n              waveLength: Math.random() * 40 + 40,\r\n              waveFreq: Math.random() * 0.2 + 0.2,\r\n              waveAmp: Math.random() * 4 + 4,\r\n              waveFlow: Math.random() * 4 + 4,\r\n              // axisRotateR: 70 * 0.85,\r\n              axisRotateR: 59.5,\r\n              rotateAngle: mouseMoveAngle,\r\n            }));\r\n          }, 160 * i);\r\n        }\r\n      }\r\n      beforeShootTime = shootTime;\r\n    }\r\n  }\r\n  getProp(propName) {\r\n    // 持續秒數\r\n    let lastTime;\r\n    switch (propName) {\r\n      case 'shield':\r\n        lastTime = 10000;\r\n        break;\r\n      case 'double':\r\n        lastTime = 20000;\r\n        break;\r\n      // case 'crackdown':\r\n      //   lastTime = 1600;\r\n      //   break;\r\n      case 'wave':\r\n        lastTime = 30000;\r\n        break;\r\n      default:\r\n        lastTime = 0;\r\n    }\r\n    // 將道具推入 shooter 的狀態\r\n    this.statuses.push(propName);\r\n    // 時間到後，移除道具效果\r\n    setTimeout(() => {\r\n      for (let i = 0; i < this.statuses.length; i += 1) {\r\n        if (this.statuses[i] === propName) {\r\n          this.statuses.splice(i, 1);\r\n          break;\r\n        }\r\n      }\r\n    }, lastTime);\r\n    // 如果 shooter 狀態為 heart，就恢復一個愛心\r\n    if (this.judgeStatus('heart')) {\r\n      this.recoverOneHeart();\r\n    }\r\n    // 如果 shooter 狀態為 crackdown，就發出清場效果\r\n    if (this.judgeStatus('crackdown')) {\r\n      this.drawCrackdownEffect();\r\n    }\r\n    // 顯示道具效果持續時間\r\n    this.displayPropInfo(propName, lastTime);\r\n  }\r\n  judgeStatus(shooterStatus) {\r\n    return this.statuses.find((status) => status === shooterStatus);\r\n  }\r\n  // 繪製清場效果\r\n  drawCrackdownEffect() {\r\n    let crackdownTime = 1;\r\n    const effect = () => {\r\n      ctx.save();\r\n        crackdownTime += 1;\r\n        ctx.beginPath();\r\n        ctx.shadowColor = 'rgba(255, 255, 255, 0.72)';\r\n        ctx.shadowBlur = 2;\r\n        // 透明度從 1 到 0\r\n        ctx.strokeStyle = `rgba(255, 255, 255, ${(100 - crackdownTime) / 98})`;\r\n        ctx.fillStyle = `rgba(255, 255, 255, ${(100 - crackdownTime) / 490})`;\r\n        ctx.lineWidth = 5;\r\n        /**\r\n         * baseLog() 從 0 到 3\r\n         * 所以 (((crackdownTime - 2) / 98) * 26) + 1 為從 1 到 27\r\n         * 清場半徑因此為從 0 到 528\r\n         */\r\n        const effectR = 176 * baseLog(3, (((crackdownTime - 2) / 98) * 26) + 1);\r\n        ctx.arc(gameW / 2, gameH / 2, effectR, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.stroke();\r\n      ctx.restore();\r\n      // 清除敵人\r\n      game.circles.forEach((circle, idx) => {\r\n        if (effectR > circle.axisRotateR) {\r\n          enemyMethods.dieEffect(circle.r, originalPos(circle.axisRotateR, circle.axisRotateAngle).x, originalPos(circle.axisRotateR, circle.axisRotateAngle).y, '245, 175, 95');\r\n          game.circles.splice(idx, 1);\r\n        }\r\n      });\r\n      game.triangles.forEach((triangle, idx) => {\r\n        if (effectR > triangle.axisRotateR) {\r\n          enemyMethods.dieEffect(triangle.r, originalPos(triangle.axisRotateR, triangle.axisRotateAngle).x, originalPos(triangle.axisRotateR, triangle.axisRotateAngle).y, '54, 118, 187');\r\n          game.triangles.splice(idx, 1);\r\n        }\r\n      });\r\n      game.polygons.forEach((polygon, idx) => {\r\n        if (effectR > polygon.axisRotateR.whole) {\r\n          if (polygon.HP.whole) {\r\n            const polygonWholeR = (34 + 21) / 2;\r\n            enemyMethods.dieEffect(polygonWholeR, polygon.originalPos('whole').x, polygon.originalPos('whole').y, '231, 70, 93');\r\n          } else {\r\n            if (polygon.HP.big) {\r\n              const polygonBigR = (34 + 22) / 2;\r\n              enemyMethods.dieEffect(polygonBigR, polygon.originalPos('big').x, polygon.originalPos('big').y, '231, 70, 93');\r\n              game.polygons.splice(idx, 1);\r\n            }\r\n            if (polygon.HP.small) {\r\n              const polygonSmallR = (23 + 21) / 2;\r\n              enemyMethods.dieEffect(polygonSmallR, polygon.originalPos('small').x, polygon.originalPos('small').y, '231, 70, 93');\r\n              game.polygons.splice(idx, 1);\r\n            }\r\n          }\r\n          game.polygons.splice(idx, 1);\r\n        }\r\n      });\r\n      game.subTriangles.forEach((subTriangle, idx) => {\r\n        if (effectR > subTriangle.axisRotateR) {\r\n          game.subTriangles.splice(idx, 1);\r\n        }\r\n      });\r\n      if (crackdownTime < 100) {\r\n        requestAnimationFrame(effect);\r\n      }\r\n    }\r\n    requestAnimationFrame(effect);\r\n  }\r\n  // 恢復一個愛心命\r\n  recoverOneHeart() {\r\n    // this.HP += 3;\r\n    const heartWrapper = document.getElementById('heart-wrapper');\r\n    const heart = document.createElement('DIV');\r\n    heart.classList.add('panel__game-heart');\r\n    heartWrapper.insertBefore(heart, heartWrapper.firstChild);\r\n  }\r\n  displayPropInfo(propName, lastTime) {\r\n    if (propName === 'crackdown' || propName === 'heart') {\r\n      return;\r\n    }\r\n    prop.style.opacity = 1;\r\n    propImg.src = `../../src/assets/${propName}--panel.svg`;\r\n    lastTime = lastTime / 1000;\r\n    propLastTime.textContent = lastTime;\r\n    setTimeout(function minusLastTime() {\r\n      lastTime -= 1;\r\n      propLastTime.textContent = lastTime;\r\n      if (!lastTime) {\r\n        prop.style.opacity = 0;\r\n      }\r\n      setTimeout(minusLastTime, 1000);\r\n    }, 1000);\r\n  }\r\n}\r\n\r\n// 以 x 為底的 y 的對數：logxy\r\nfunction baseLog(x, y) {\r\n  return Math.log(y) / Math.log(x);\r\n}\r\n\r\n\r\n/* Shooter 子彈 */\r\nclass ShooterBullet {\r\n  constructor(args) {\r\n    const def = {\r\n      // p: new Vec2(0, 0),\r\n      // bodyLength: 15 * 0.85,\r\n      bodyLength: 12.75,\r\n      axisRotateR: 0,\r\n      color: globalColor.white,\r\n      v: 8,\r\n      rotateAngle: 0,\r\n      waveLength: 40,\r\n      waveFreq: 0.2,\r\n      waveAmp: 4,\r\n      waveFlow: 4,\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.translate(gameW / 2, gameH / 2);\r\n      ctx.rotate(this.rotateAngle);\r\n      // ctx.translate(this.p.x, this.p.y);\r\n      if (!game.shooter.judgeStatus('wave')) {\r\n        // 殘影\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\r\n        // ctx.arc(-7 * 0.85 + this.axisRotateR, 0, 3 * 0.85, 0, Math.PI * 2);\r\n        ctx.arc(-5.95 + this.axisRotateR, 0, 2.15, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\r\n        // ctx.arc(-12 * 0.85 + this.axisRotateR, 0, 2 * 0.85, 0, Math.PI * 2);\r\n        ctx.arc(-10.2 + this.axisRotateR, 0, 1.7, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';\r\n        // ctx.arc(-15 * 0.85 + this.axisRotateR, 0, 1 * 0.85, 0, Math.PI * 2);\r\n        ctx.arc(-12.75 + this.axisRotateR, 0, 0.85, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        // 園底\r\n        ctx.beginPath();\r\n        ctx.fillStyle = this.color;\r\n        // ctx.arc(0 + this.axisRotateR, 0, 4 * 0.85, 0, Math.PI * 2);\r\n        ctx.arc(0 + this.axisRotateR, 0, 3.4, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        // 尖頭\r\n        ctx.beginPath();\r\n        // ctx.moveTo(3 * 0.85 + this.axisRotateR, 3 * 0.85);\r\n        ctx.moveTo(2.55 + this.axisRotateR, 2.55);\r\n        ctx.lineTo(this.bodyLength + this.axisRotateR, 0);\r\n        // ctx.lineTo(3 * 0.85 + this.axisRotateR, -3 * 0.85);\r\n        ctx.lineTo(2.55 + this.axisRotateR, -2.55);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 如果 shooter 狀態為 wave\r\n      } else {\r\n        this.drawWaveBullet();\r\n      }\r\n    ctx.restore();\r\n  }\r\n  update(bulletIdx) {\r\n    // 移動子彈\r\n    this.axisRotateR += this.v;\r\n    // 判斷子彈為哪一類型\r\n    let anglePanFn;\r\n    let shotRRangeFn;\r\n    // 一般類型\r\n    if (!game.shooter.judgeStatus('wave')) {\r\n      const bulletMoveLength = this.axisRotateR + this.bodyLength;\r\n      // 判斷子彈有無射中圓形\r\n      game.circles.forEach((circle, cirIdx) => {\r\n        anglePanFn = () => {\r\n          return Math.asin(circle.r / circle.axisRotateR);\r\n        }\r\n        shotRRangeFn = () => {\r\n          // const bulletMoveLength = this.axisRotateR + this.bodyLength;\r\n          return (bulletMoveLength >= (circle.axisRotateR - (circle.r / 2))) && (bulletMoveLength <= (circle.axisRotateR + (circle.r / 2)));\r\n        }\r\n        this.attackEnemy(circle, cirIdx, game.circles, bulletIdx, anglePanFn, shotRRangeFn, '245, 175, 95');\r\n      });\r\n      // 判斷子彈有無射中三角形\r\n      game.triangles.forEach((triangle, triIdx) => {\r\n        // const lengthX = triangle.axisRotateR.x * Math.cos(triangle.axisRotateAngle * degToPi);\r\n        // const lengthY = triangle.axisRotateR.y * Math.sin(triangle.axisRotateAngle * degToPi);\r\n        // const length = Math.sqrt(lengthX * lengthX + lengthY * lengthY);\r\n        anglePanFn = () => {\r\n          const lengthX = triangle.axisRotateR + (triangle.r / 2);\r\n          const lengthY = (triangle.r / 2) * Math.sqrt(3);\r\n          return Math.atan2(lengthY, lengthX);\r\n        }\r\n        shotRRangeFn = () => {\r\n          // const bulletMoveLength = this.axisRotateR + this.bodyLength;\r\n          return (bulletMoveLength >= triangle.axisRotateR) && (bulletMoveLength <= (triangle.axisRotateR + (triangle.r / 2)));\r\n        }\r\n        this.attackEnemy(triangle, triIdx, game.triangles, bulletIdx, anglePanFn, shotRRangeFn, '54, 118, 187');\r\n      });\r\n      // 判斷子彈有無射中多邊形\r\n      game.polygons.forEach((polygon, polyIdx) => {\r\n        // 當多邊形未分裂\r\n        if (polygon.HP.whole) {\r\n          shotRRangeFn = () => {\r\n            // const bulletMoveLength = this.axisRotateR + this.bodyLength;\r\n            const sideA = polygon.axisRotateR.whole;\r\n            return (bulletMoveLength >= sideA) && (bulletMoveLength <= (sideA + 9));\r\n          }\r\n          this.attackPolygon(polygon, polyIdx, 'whole', 34, 21, (360 - (202 + 75)), (8 + 75), 75, bulletIdx, shotRRangeFn, '231, 70, 93');\r\n        } else {\r\n          // 當多邊形分裂\r\n          // 大分裂\r\n          if (polygon.HP.big) {\r\n            shotRRangeFn = () => {\r\n              // const bulletMoveLength = this.axisRotateR + this.bodyLength;\r\n              const sideA = polygon.axisRotateR.big;\r\n              return (bulletMoveLength >= sideA + 8) && (bulletMoveLength <= (sideA + 16));\r\n            }\r\n            this.attackPolygon(polygon, polyIdx, 'big', 34, 23, ((202 + 44) - 180), (180 - (70 + 44)), 44, bulletIdx, shotRRangeFn, '231, 70, 93');\r\n          }\r\n          // 小分裂\r\n          if (polygon.HP.small) {\r\n            shotRRangeFn = () => {\r\n              // const bulletMoveLength = this.axisRotateR + this.bodyLength;\r\n              const sideA = polygon.axisRotateR.small;\r\n              return (bulletMoveLength >= sideA + 8) && (bulletMoveLength <= (sideA + 16));\r\n            }\r\n            this.attackPolygon(polygon, polyIdx, 'small', 22, 23, ((255 + 17.5) - 180), (180 - (70 + 17.5)), 17.5, bulletIdx, shotRRangeFn, '231, 70, 93');\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      // FIXME 多邊形判斷不準\r\n      // 波狀類型\r\n      // 有無射中圓形\r\n      game.circles.forEach((circle, cirIdx) => {\r\n        anglePanFn = () => {\r\n          return Math.asin(circle.r / circle.axisRotateR);\r\n        }\r\n        shotRRangeFn = () => {\r\n          return (this.axisRotateR >= (circle.axisRotateR - (circle.r / 2))) && (this.axisRotateR <= (circle.axisRotateR + (circle.r / 2)));\r\n        }\r\n        this.attackEnemy(circle, cirIdx, game.circles, bulletIdx, anglePanFn, shotRRangeFn, '245, 175, 95', 'wave');\r\n      });\r\n      // 有無射中三角形\r\n      game.triangles.forEach((triangle, triIdx) => {\r\n        anglePanFn = () => {\r\n          const lengthX = triangle.axisRotateR + (triangle.r / 2);\r\n          const lengthY = (triangle.r / 2) * Math.sqrt(3);\r\n          return Math.atan2(lengthY, lengthX);\r\n        }\r\n        shotRRangeFn = () => {\r\n          return (this.axisRotateR >= triangle.axisRotateR) && (this.axisRotateR <= (triangle.axisRotateR + (triangle.r / 2)));\r\n        }\r\n        this.attackEnemy(triangle, triIdx, game.triangles, bulletIdx, anglePanFn, shotRRangeFn, '54, 118, 187', 'wave');\r\n      });\r\n      // 有無射中多邊形\r\n      game.polygons.forEach((polygon, polyIdx) => {\r\n        // 當多邊形未分裂\r\n        if (polygon.HP.whole) {\r\n          shotRRangeFn = () => {\r\n            const sideA = polygon.axisRotateR.whole;\r\n            return (this.axisRotateR >= sideA) && (this.axisRotateR <= (sideA + 9));\r\n          }\r\n          this.attackPolygon(polygon, polyIdx, 'whole', 34, 21, (360 - (202 + 75)), (8 + 75), 75, bulletIdx, shotRRangeFn, '231, 70, 93', 'wave');\r\n        } else {\r\n          // 當多邊形分裂\r\n          // 大分裂\r\n          if (polygon.HP.big) {\r\n            shotRRangeFn = () => {\r\n              const sideA = polygon.axisRotateR.big;\r\n              return (this.axisRotateR >= sideA + 8) && (this.axisRotateR <= (sideA + 16));\r\n            }\r\n            this.attackPolygon(polygon, polyIdx, 'big', 34, 23, ((202 + 44) - 180), (180 - (70 + 44)), 44, bulletIdx, shotRRangeFn, '231, 70, 93', 'wave');\r\n          }\r\n          // 小分裂\r\n          if (polygon.HP.small) {\r\n            shotRRangeFn = () => {\r\n              const sideA = polygon.axisRotateR.small;\r\n              return (this.axisRotateR >= sideA + 8) && (this.axisRotateR <= (sideA + 16));\r\n            }\r\n            this.attackPolygon(polygon, polyIdx, 'small', 22, 23, ((255 + 17.5) - 180), (180 - (70 + 17.5)), 17.5, bulletIdx, shotRRangeFn, '231, 70, 93', 'wave');\r\n          }\r\n          // 移除大小分裂效果\r\n          // if (!polygon.HP.big) {\r\n          //   enemyMethods.dieEffect(enemy, enemy.r, colorRGB);\r\n          // }\r\n          // 如果大小分裂都被擊斃了，那就移除此多邊形\r\n          if (!polygon.HP.big && !polygon.HP.small) {\r\n            game.polygons.splice(polyIdx, 1);\r\n            // 電池加一\r\n            game.batteryNum += 1;\r\n            batteryNum.textContent = game.batteryNum;\r\n          }\r\n        }\r\n      });\r\n    }\r\n    // 當子彈超出邊界\r\n    this.beyondBoundary(bulletIdx);\r\n  }\r\n  // 繪製波狀子彈\r\n  drawWaveBullet() {\r\n    ctx.strokeStyle = this.color;\r\n    ctx.lineWidth = 1.6;\r\n    ctx.shadowColor = 'rgba(255, 255, 255, 0.72)';\r\n    ctx.shadowBlur = 2;\r\n    // 正半波\r\n    ctx.beginPath();\r\n    for (let i = 0; i < this.waveLength; i += 1) {\r\n      const degree = (i * this.waveFreq) + (time / this.waveFlow);\r\n      ctx.lineTo(this.axisRotateR + (this.waveAmp * Math.sin(degree)), i);\r\n    }\r\n    ctx.stroke();\r\n    // 負半波\r\n    ctx.beginPath();\r\n    for (let i = 0; i < this.waveLength; i += 1) {\r\n      const degree = (i * this.waveFreq) + (time / this.waveFlow);\r\n      ctx.lineTo(this.axisRotateR + (this.waveAmp * Math.sin(degree)), -i);\r\n    }\r\n    ctx.stroke();\r\n  }\r\n  // 攻擊敵人（圓形、三角形）\r\n  attackEnemy(enemy, enemyIdx, enemies, bulletIdx, anglePanFn, shotRRangeFn, colorRGB, type = 'ordinary') {\r\n    /**\r\n     * 射中角度範圍\r\n     * 圓形：取得兩個外切線所構成角度的一半\r\n     * 三角形：取得射中角度範圍的一半\r\n     */\r\n    const enemyAnglePan = anglePanFn();\r\n    const enemyAngleMinus = (enemy.axisRotateAngle % 360) * degToPi - enemyAnglePan;\r\n    const enemyAngleAdd = (enemy.axisRotateAngle % 360) * degToPi + enemyAnglePan;\r\n    const shotAngleRange = this.judgeShotAngleRange(enemyAngleMinus, enemyAngleAdd, type);\r\n    // 射中距離範圍\r\n    const shotRRange = shotRRangeFn();\r\n    // 判斷子彈有無射中敵人\r\n    if (shotAngleRange && shotRRange) {\r\n      // 移除子彈\r\n      game.shooter.bullets.splice(bulletIdx, 1);\r\n      // 扣敵人 1 生命值\r\n      enemy.HP -= 1;\r\n      if (!enemy.HP) {\r\n        // 若生命值 0，移除敵人\r\n        enemies.splice(enemyIdx, 1);\r\n        // 移除效果\r\n        enemyMethods.dieEffect(enemy.r, originalPos(enemy.axisRotateR, enemy.axisRotateAngle).x, originalPos(enemy.axisRotateR, enemy.axisRotateAngle).y, colorRGB);\r\n        // 電池加一\r\n        game.batteryNum += 1;\r\n        batteryNum.textContent = game.batteryNum;\r\n      }\r\n    }\r\n  }\r\n  // 攻擊多邊形\r\n  attackPolygon(polygon, polyIdx, form, sideB1Len, sideB2Len, angleAB1, angleAB2, rotateAngleJudge, bulletIdx, shotRRangeFn, type = 'ordinary') {\r\n    const polyAxisRotateAngle = polygon.axisRotateAngle[form];\r\n    const polyRotate = polygon.rotate[form];\r\n    // 取得兩側射中最大角度\r\n    const sideA = polygon.axisRotateR[form];\r\n    const sideB1 = sideB1Len;\r\n    const sideB2 = sideB2Len;\r\n    /**\r\n     * 兩側點愈靠近軸心，夾角便愈大\r\n     *   whole: 8°, 202°\r\n     *   big: 70°, 202°\r\n     *   small: 70°, 255°\r\n\r\n     * 相同軸半徑下，當多邊形呈某一角度，兩側點離軸心（幾乎）最近，angleB 相同\r\n     *   whole: axisRotateAngle 180°, rotate 75°\r\n     *     270 - 202 = 68\r\n     *     90 - 8 = 82\r\n     *     (68 + 82) / 2 = 75\r\n     * \r\n     *   big: axisRotateAngle 0°, rotate 44°\r\n     *     270 - 202 = 68\r\n     *     90 - 70 = 20\r\n     *     (68 + 20) / 2 = 44\r\n     * \r\n     *   small: axisRotateAngle 0°, rotate 17.5°\r\n     *     270 - 255 = 15\r\n     *     90 - 70 = 20\r\n     *     (15 + 20) / 2 = 17.5\r\n     */\r\n    const sideC1 = cosineFormula(sideA, sideB1, angleAB1);\r\n    const sideC2 = cosineFormula(sideA, sideB2, angleAB2);\r\n    // 當多邊形的 axisRotateAngle、rotate 不同，要加上與減去的角度也不一樣\r\n    const bottomJudge = (polyAxisRotateAngle <= 180) && ((polyRotate % 360) < rotateAngleJudge || (polyRotate % 360) >= (rotateAngleJudge + 180));\r\n    const topJudge = (polyAxisRotateAngle > 180) && ((polyRotate % 360) >= rotateAngleJudge || (polyRotate % 360) < (rotateAngleJudge + 180));\r\n    let angleB1;\r\n    let angleB2;\r\n    if (bottomJudge || topJudge) {\r\n      angleB1 = getAngleB(sideA, sideB2, sideC2);\r\n      angleB2 = getAngleB(sideA, sideB1, sideC1);\r\n    } else {\r\n      angleB1 = getAngleB(sideA, sideB1, sideC1);\r\n      angleB2 = getAngleB(sideA, sideB2, sideC2);\r\n    }\r\n    /**\r\n     * 射中角度範圍\r\n     * 多邊形不會繞軸旋轉，axisRotateAngle 固定，不用 % 360\r\n     */\r\n    const polyAngleMinus = polyAxisRotateAngle * degToPi - angleB1;\r\n    const polyAngleAdd = polyAxisRotateAngle * degToPi + angleB2;\r\n    const shotAngleRange = this.judgeShotAngleRange(polyAngleMinus, polyAngleAdd, type);\r\n    // 射中距離範圍\r\n    const shotRRange = shotRRangeFn();\r\n    // 判斷子彈有無射中多邊形\r\n    if (shotAngleRange && shotRRange) {\r\n      // 移除子彈\r\n      game.shooter.bullets.splice(bulletIdx, 1);\r\n      // 扣 1 生命值\r\n      polygon.HP[form] -= 1;\r\n      // 若大或小分裂生命值為 0\r\n      if (!polygon.HP.big || !polygon.HP.small) {\r\n        // 移除效果\r\n        const polygonR = form === 'big' ? (34 + 22) / 2 : (23 + 21) / 2;\r\n        enemyMethods.dieEffect(polygonR, polygon.originalPos(form).x, polygon.originalPos(form).y, '231, 70, 93');\r\n      }\r\n      // 如果大小分裂都被擊斃了，那就移除此多邊形\r\n      if (!polygon.HP.big && !polygon.HP.small) {\r\n        game.polygons.splice(polyIdx, 1);\r\n        // 電池加一\r\n        game.batteryNum += 1;\r\n        batteryNum.textContent = game.batteryNum;\r\n      }\r\n    }\r\n  }\r\n  // 判斷射中角度範圍\r\n  judgeShotAngleRange(enemyAngleMinus, enemyAngleAdd, type) {\r\n    const shooterRotateAngle = (enemyAngleMinus < 0 && this.rotateAngle > Math.PI) ? (this.rotateAngle - Math.PI * 2) : this.rotateAngle;\r\n    // 判斷子彈為哪一類型\r\n    // 一般子彈\r\n    if (type !== 'wave') {\r\n      return shooterRotateAngle >= enemyAngleMinus && shooterRotateAngle <= enemyAngleAdd;\r\n    } else {\r\n      // 波狀子彈\r\n      const shooterAnglePan = Math.atan2(this.waveLength, this.axisRotateR);\r\n      const shooterAngleMinus = shooterRotateAngle - shooterAnglePan;\r\n      const shooterAngleAdd = shooterRotateAngle + shooterAnglePan;\r\n      return (enemyAngleMinus <= shooterAngleAdd) && (enemyAngleAdd >= shooterAngleMinus);\r\n    }\r\n  }\r\n  // 當子彈超出邊界\r\n  beyondBoundary(bulletIdx) {\r\n    /**\r\n     * 856 / 2 = 428\r\n     * 624 / 2 = 312\r\n     * Math.sqrt(428 * 428 + 312 * 312) = 529.6\r\n     */\r\n    if (this.axisRotateR >= 530) {\r\n      game.shooter.bullets.splice(bulletIdx, 1);\r\n    }  \r\n  }\r\n}\r\n\r\n\r\n\r\n/* Sub Triangle 類別 */\r\nclass TriangleSub {;\r\n  constructor(args) {\r\n    const def = {\r\n      // axisRotatePos: {\r\n      //   x: gameW / 2,\r\n      //   y: gameH / 2,\r\n      // },\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      // r: 26 * 0.4,\r\n      r: 10.4,\r\n      rotate: 0,\r\n      rotateV: 4,\r\n      color: globalColor.blue,\r\n      HP: 2,\r\n      isReproduceMoving: false,\r\n      order: 0,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    // const scale = 0.4;\r\n    const triangleOuterBigR = this.r + 1.6;\r\n    const triangleInnerBigR = this.r - 6.4;\r\n    const triangleInnerSmallR = this.r - 8.8;\r\n    ctx.save();\r\n      // 淡三角\r\n      ctx.translate(originalPos(this.axisRotateR, this.axisRotateAngle).x, originalPos(this.axisRotateR, this.axisRotateAngle).y);\r\n      // ctx.scale(0.4, 0.4);\r\n      ctx.rotate(this.rotate * degToPi);\r\n      ctx.save();\r\n        ctx.translate(0.8, -Math.sqrt(1.92));\r\n        ctx.beginPath();\r\n        ctx.moveTo(triangleOuterBigR * Math.cos(0), triangleOuterBigR * Math.sin(0));\r\n        ctx.lineTo(triangleOuterBigR * Math.cos(120 * degToPi), triangleOuterBigR * Math.sin(120 * degToPi));\r\n        ctx.lineTo(triangleOuterBigR * Math.cos(240 * degToPi), triangleOuterBigR * Math.sin(240 * degToPi));\r\n        ctx.closePath();\r\n        ctx.fillStyle = 'rgba(54, 118, 187, 0.34)';\r\n        ctx.fill();\r\n      ctx.restore();\r\n      // 主體三角\r\n      ctx.beginPath();\r\n      ctx.moveTo(this.r * Math.cos(0), this.r * Math.sin(0));\r\n      ctx.lineTo(this.r * Math.cos(120 * degToPi), this.r * Math.sin(120 * degToPi));\r\n      ctx.lineTo(this.r * Math.cos(240 * degToPi), this.r * Math.sin(240 * degToPi));\r\n      ctx.closePath();\r\n      ctx.fillStyle = this.color;\r\n      ctx.fill();\r\n      // 大白三角\r\n      ctx.translate(-1.28, -0.64);\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(triangleInnerBigR * Math.cos(30 * degToPi), triangleInnerBigR * Math.sin(30 * degToPi));\r\n      ctx.lineTo(triangleInnerBigR * Math.cos(90 * degToPi), triangleInnerBigR * Math.sin(90 * degToPi));\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 小白三角\r\n      ctx.translate(0, -3.52);\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(triangleInnerSmallR * Math.cos(30 * degToPi), triangleInnerSmallR * Math.sin(30 * degToPi));\r\n      ctx.lineTo(triangleInnerSmallR * Math.cos(90 * degToPi), triangleInnerSmallR * Math.sin(90 * degToPi));\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  update(idx) {\r\n    this.rotate += this.rotateV;\r\n    if (!this.isReproduceMoving) {\r\n      TweenLite.to(this, 0.8, {\r\n        axisRotateAngle: `${this.order === 1 ? '+=' : '-='}10`,\r\n        ease: Power2.easeOut,\r\n        onComplete: () => {\r\n          TweenLite.to(this, 1.6, {\r\n            axisRotateR: 0,\r\n            ease: Power1.easeIn,\r\n          });\r\n        }\r\n      });\r\n      this.isReproduceMoving = true;\r\n    }\r\n    // 當小三角形撞上 shooter\r\n    enemyMethods.hitShooter(game.subTriangles, idx, 'triangle', this.axisRotateR, this.axisRotateAngle);\r\n  }\r\n}\r\n\r\n\r\n/* Circle 子彈 */\r\nclass CircleBullet {\r\n  constructor(args) {\r\n    const def = {\r\n      p: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      axisRotateR: 0,\r\n      color: globalColor.orange,\r\n      moveX: 0,\r\n      moveXV: -3,\r\n      // v: 4,\r\n      rotateAngle: 0,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.translate(this.p.x, this.p.y);\r\n      ctx.rotate(this.rotateAngle * degToPi); \r\n      // ctx.scale(1.6, 0.68);\r\n      // ctx.scale(1, 0.9);\r\n      ctx.beginPath();\r\n      // ctx.arc(this.moveX + 22 + 10, 0, 4, 0, Math.PI * 2);\r\n      ctx.arc(this.moveX, 0, 4, 0, Math.PI * 2);\r\n      // ctx.arc(this.axisRotateR + 16, 0, 4, 0, Math.PI * 2);\r\n      ctx.fillStyle = this.color;\r\n      ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  update(idx, arr) {\r\n    // 圓形子彈移動\r\n    this.moveX += this.moveXV;\r\n    // 子彈擊中 shooter\r\n    enemyMethods.bulletAttackShooter(this, idx, arr);\r\n  }\r\n}\r\n\r\n\r\n/* Triangle 子彈 */\r\nclass TriangleBullet {;\r\n  constructor(args) {\r\n    const def = {\r\n      p: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      moveX: 0,\r\n      moveXV: -4,\r\n      rotateAngle: 0,\r\n      color: globalColor.blue,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.translate(this.p.x, this.p.y);\r\n      ctx.rotate(this.rotateAngle * degToPi);\r\n      ctx.translate(this.moveX, 0);\r\n      // 主體三角子彈\r\n      ctx.fillStyle = this.color;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-16, 0);\r\n      ctx.$triLineTo(38, 174);\r\n      ctx.$triLineTo(16.8, 200);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 淡三角子彈\r\n      ctx.fillStyle = 'rgba(54, 118, 187, 0.34)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(-16.4, 0);\r\n      ctx.$triLineTo(38, 174);\r\n      ctx.$triLineTo(15.6, 168);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  update(idx, arr) {\r\n    // 三角子彈移動\r\n    this.moveX += this.moveXV;\r\n    // 子彈擊中 shooter\r\n    enemyMethods.bulletAttackShooter(this, idx, arr, 37.8);\r\n    // 當子彈超出邊界\r\n    this.beyondBoundary(idx, arr);\r\n  }\r\n  // 當子彈超出邊界\r\n  beyondBoundary(idx, arr) {\r\n     // Math.sqrt(856 * 856 + 624 * 624) = 1059.3\r\n    if (this.moveX <= -1060) {\r\n      arr.splice(idx, 1);\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n// 繪製電池\r\nfunction drawBattery(p) {\r\n  ctx.save();\r\n    ctx.translate(p.x, p.y);\r\n    ctx.fillStyle = globalColor.orange;\r\n    // 瓶身\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.lineTo(-24, 0);\r\n    ctx.lineTo(-24, 42);\r\n    ctx.lineTo(0, 42);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    // 瓶底\r\n    ctx.save();\r\n      ctx.translate(0, 44);\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(-24, 0);\r\n      ctx.lineTo(-24, 3);\r\n      ctx.lineTo(0, 3);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n    // 瓶蓋\r\n    ctx.fillStyle = globalColor.white;\r\n    ctx.save();\r\n      ctx.translate(-6.75, 0);\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(0, -3);\r\n      ctx.lineTo(-10.5, -3);\r\n      ctx.lineTo(-10.5, -0);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n    // 閃電\r\n    // ctx.strokeStyle = globalColor.white;\r\n    drawLightning({ x: -11, y: 9 });\r\n    // ctx.translate(-11, 9);\r\n    // ctx.beginPath();\r\n    // ctx.moveTo(0, 0);\r\n    // ctx.rotate(18 * degToPi);\r\n    // ctx.lineTo(0, 10);\r\n    // ctx.translate(0, 10);\r\n    // ctx.rotate(-18 * degToPi);\r\n\r\n    // ctx.lineTo(10, 0);\r\n    // ctx.translate(10, 0);\r\n\r\n    // ctx.rotate(28 * degToPi);\r\n    // ctx.lineTo(0, 16);\r\n    // ctx.translate(0, 16);\r\n    // ctx.rotate(-28 * degToPi);\r\n\r\n    // ctx.rotate(3.6 * degToPi);\r\n    // ctx.lineTo(0, -10);\r\n    // ctx.translate(0, -10);\r\n    // ctx.rotate(-3.6 * degToPi);\r\n\r\n    // ctx.lineTo(-8, 0);\r\n    // ctx.closePath();\r\n    // ctx.fill();\r\n  ctx.restore();\r\n}\r\n\r\n\r\nfunction originalPos(axisRotateR, axisRotateAngle) {\r\n  return {\r\n    x: (gameW / 2) + axisRotateR * Math.cos(axisRotateAngle * degToPi),\r\n    y: (gameH / 2) + axisRotateR * Math.sin(axisRotateAngle * degToPi),\r\n  };\r\n}\r\n\r\n// 餘弦定理\r\nfunction cosineFormula(a, b, angle) {\r\n  return Math.sqrt(a * a + b * b - 2 * a * b * Math.cos(angle * degToPi));\r\n}\r\n\r\nfunction getAngleB(a, b, c) {\r\n  return Math.acos((a * a + c * c - b * b) / (2 * a * c));\r\n}\r\n\r\n// 繪製閃電\r\nfunction drawLightning(translate =  { x: 0, y: 0 }, scale = 1 ) {\r\n  ctx.fillStyle = globalColor.white;\r\n  ctx.translate(translate.x, translate.y);\r\n  ctx.beginPath();\r\n  ctx.moveTo(0, 0);\r\n  ctx.rotate(18 * degToPi);\r\n  ctx.lineTo(0, 10 * scale);\r\n  ctx.translate(0, 10 * scale);\r\n  ctx.rotate(-18 * degToPi);\r\n\r\n  ctx.lineTo(10 * scale, 0);\r\n  ctx.translate(10 * scale, 0);\r\n\r\n  ctx.rotate(28 * degToPi);\r\n  ctx.lineTo(0, 16 * scale);\r\n  ctx.translate(0, 16 * scale);\r\n  ctx.rotate(-28 * degToPi);\r\n\r\n  ctx.rotate(3.6 * degToPi);\r\n  ctx.lineTo(0, -10 * scale);\r\n  ctx.translate(0, -10 * scale);\r\n  ctx.rotate(-3.6 * degToPi);\r\n\r\n  ctx.lineTo(-8 * scale, 0);\r\n  ctx.closePath();\r\n  ctx.fill();\r\n}\r\n\r\n/* Initialize Game Logic */\r\n// function init() {\r\n\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n/* Update Game Logic */\r\n// function update() {\r\n//   time += 1;\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n/* Page Loaded */\r\nfunction handleLoad() {\r\n  game = new Game();\r\n  initCanvas();\r\n  game.init();\r\n  // init();\r\n  // requestAnimationFrame(draw);\r\n  // setInterval(update, 1000 / updateFPS);\r\n}\r\n\r\n// load & resize event\r\nwindow.addEventListener('load', handleLoad);\r\nwindow.addEventListener('resize', initCanvas);\r\n\r\n\r\n\r\n\r\n\r\n/* Mouse Events & Recording */\r\n// const mouseMovePos = new Vec2(0, 0);\r\nlet mouseMovePos = {};\r\nlet mouseMoveAngle = 0;\r\n// let mouseUpPos = new Vec2(0, 0);\r\n// let mouseDownPos = new Vec2(0, 0);\r\n\r\n// window.addEventListener('mousemove', handleMouseMove);\r\n// window.addEventListener('mouseup', handleMouseUp);\r\n// window.addEventListener('mousedown', handleMouseDown);\r\n// canvas.addEventListener('mousemove', handleMouseMove);\r\n\r\nfunction handleMouseMove(evt) {\r\n  if (game.isPause) return;\r\n  mouseMovePos.x = evt.x - ww / 2;\r\n  mouseMovePos.y = evt.y - wh / 2;\r\n  const angle = Math.atan2(mouseMovePos.y, mouseMovePos.x);\r\n  mouseMoveAngle = angle < 0 ? (angle + 2 * Math.PI) : angle;\r\n  // mouseMoveAngle = Math.atan2(mouseMovePos.y, mouseMovePos.x);\r\n};\r\n\r\n// canvas.addEventListener('click', handleClick);\r\n// window.addEventListener('keyup', handleKeyup);\r\n\r\nlet beforeShootTime = new Date();\r\nfunction handleClick() {\r\n  game.shooter.shoot();\r\n};\r\n\r\nfunction handleKeyup(evt) {\r\n  if (evt.key === 's') {\r\n    game.shooter.shoot();\r\n  }\r\n  if (evt.key === 'p') {\r\n    game.pauseGame();\r\n  }\r\n}\r\n\r\n// function handleMouseUp(evt) {\r\n//   mouseUpPos = mouseMovePos.clone();\r\n// }\r\n\r\n// function handleMouseDown(evt) {\r\n//   mouseDownPos = mouseMovePos.clone();\r\n// }"]}