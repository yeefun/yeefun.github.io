<!DOCTYPE html>
html(lang="zh-Hant-TW")
    head
        meta(charset="UTF-8")
        meta(name="viewport", content="width=device-width, initial-scale=1.0")
        meta(http-equiv="X-UA-Compatible", content="ie=edge")
        title The F2E - Todolist

        link(rel="stylesheet", href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css")

        link(rel="stylesheet", href="https://use.fontawesome.com/releases/v5.2.0/css/regular.css")
        link(rel="stylesheet", href="https://use.fontawesome.com/releases/v5.2.0/css/fontawesome.css")

        link(rel="stylesheet", href="css/style.css")
    body

        nav
            section.navbar
                .item.active(@click="all") 我的任務
                .item(@click="inProgress") 待處理
                .item(@click="completed") 已處理

        section#todos
            #todos__add(v-if="notAdd", @click="todoAddClick")
                input(type="text", placeholder="新增任務")
                span +

            #todos__new(:class="{ open: !notAdd }")
                article.todo.edit.icon-empty
                    section.menu-head(:class="{ star: newTodo.star }")
                        .menu-head__control
                            span +
                            input#new-title(type="text", placeholder="你的任務名稱", v-model="newTodo.title")
                            i.far.fa-star(
                                :class="{ active: newTodo.star }", 
                                @click="newTodo.star=!newTodo.star")
                            i.far.fa-edit.active
                    section.menu-body(:class="{ open: !notAdd }")
                        .menu-body__edit
                            section.deadline
                                .menu-body__subtitle
                                    i.far.fa-calendar-alt
                                    span 到期日
                                .menu-body__input
                                    input(type="date", v-model="newTodo.date")
                                    input(type="time", v-model="newTodo.time")
                            section.file
                                .menu-body__subtitle
                                    i.far.fa-file
                                    span 附檔
                                .menu-body__input
                                    div.file__detail(v-if="newTodo.fileName")
                                        .file__name {{newTodo.fileName}}
                                        .file__upload-date {{newTodo.fileUploadDate}}
                                    input(type="file", @change="fileSelected($event)")
                                    input(type="button", value="+", @click="fileClick")
                            section.comment
                                .menu-body__subtitle
                                    i.far.fa-comment-dots
                                    span 附註
                                .menu-body__input
                                    textarea(placeholder="新增附註", v-model="newTodo.comment")
                        .menu-body__decision
                            .cancel(@click="newTodoCancel")
                                span ×
                                | 取消
                            .save(@click="todoAdd")
                                span +
                                | 新增

            #todos__todo
                article.todo(draggable="true", v-for="(todo, idx) in todos", @dragstart="dragStart", @dragend="dragEnd", @dragenter="dragEnter", @dragover="dragOver", @drop="drop", :class="todoModes(idx)" :style="{ order: idx }")
                    section.menu-head(:class="{ star: todo.star }")
                        .menu-head__control
                            input(type="checkbox", :id="'checked'+idx", v-model="todo.completed", @change="todoCompleted($event, idx)")
                            label(:for="'checked'+idx")
                                div
                            input(type="text", :id="'title'+idx", placeholder="你的任務名稱", v-model="todo.title")
                            i.far.fa-star(
                                :class="{ active: todo.star }", 
                                @click="todo.star=!todo.star")
                            i.far.fa-edit(
                                :class="{ active: todo.open }", 
                                @click="todoEdit($event, idx)")
                        .menu-head__icon
                            div(v-if="(todo.date || todo.time) && !todo.open")
                                i.far.fa-calendar-alt
                                span {{setCalendar(idx)}}
                            i.far.fa-file(v-if="todo.fileName && !todo.open")
                            i.far.fa-comment-dots(v-if="todo.comment && !todo.open")
                        .menu-head__drag-dot
                            .dot
                            .dot
                            .dot

                    section.menu-body(:class="{ open: todo.open }")
                        .menu-body__edit
                            section.deadline
                                .menu-body__subtitle
                                    i.far.fa-calendar-alt
                                    span 到期日
                                .menu-body__input
                                    input(type="date", v-model="todo.date", :class="{ 'has-value': todo.date }")
                                    input(type="time", v-model="todo.time", :class="{ 'has-value': todo.date }")
                            section.file
                                .menu-body__subtitle
                                    i.far.fa-file
                                    span 附檔
                                .menu-body__input
                                    div.file__detail(v-if="todo.fileName")
                                        .file__name {{todo.fileName}}
                                        .file__upload-date {{todo.fileUploadDate}}
                                    input(type="file", @change="fileSelected($event, idx)")
                                    input(type="button", value="+", @click="fileClick")
                            section.comment
                                .menu-body__subtitle
                                    i.far.fa-comment-dots
                                    span 附註
                                .menu-body__input
                                    textarea(placeholder="新增附註", v-model="todo.comment")
                        .menu-body__decision
                            .cancel(@click="todoCancel(idx)")
                                span ×
                                | 取消
                            .save(@click="todo.open=false")
                                span +
                                | 儲存
            #todos__remain {{todoRemain}}


        script(src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.min.js")
        script(src="js/script-dist.js")